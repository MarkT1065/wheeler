?   	stonks	[no test files]
?   	stonks/internal/database	[no test files]
=== RUN   TestIndex
2025/10/29 19:10:22 parsing time "2025-09-19" as "2006-01-02 15:04:05": cannot parse "" as "15"
FAIL	stonks/internal/models	0.449s
=== RUN   TestLivePolygonIntegration
2025/10/29 19:10:23 [MIGRATION] Commission data migration already completed, skipping
    live_integration_test.go:48: Running live integration tests with API key: PjP...v0f
=== RUN   TestLivePolygonIntegration/TestAPIKeyValidation
    live_integration_test.go:64: ✅ API key is valid
=== RUN   TestLivePolygonIntegration/TestServiceConnection
2025/10/29 19:10:23 [POLYGON] Using API key: PjP...v0f
    live_integration_test.go:73: ✅ Service connection successful
=== RUN   TestLivePolygonIntegration/TestGetPreviousClose
    live_integration_test.go:101: ✅ AAPL previous close: $269.70
=== RUN   TestLivePolygonIntegration/TestGetLastQuote
    live_integration_test.go:109: GetLastQuote endpoint not available with current API key (likely free tier): forbidden: API key may not have access to this endpoint (status 403)
=== RUN   TestLivePolygonIntegration/TestGetTickerDetails
    live_integration_test.go:160: ✅ GOOGL details: Alphabet Inc. Class A Common Stock (stocks)
=== RUN   TestLivePolygonIntegration/TestGetDividends
    live_integration_test.go:187: ✅ KO recent dividend: $0.510 on 2025-12-01
=== RUN   TestLivePolygonIntegration/TestSpecialCharacterSymbol
    live_integration_test.go:210: ✅ BRK.A (special character) price: $712900.00
=== RUN   TestLivePolygonIntegration/TestServiceSymbolPriceUpdate
2025/10/29 19:10:23 [POLYGON] Using API key: PjP...v0f
2025/10/29 19:10:23 [POLYGON] Updating price for symbol: TSLA
2025/10/29 19:10:23 [POLYGON] Updated TSLA price to $461.51
    live_integration_test.go:239: ✅ TSLA price updated in database: $461.51
=== RUN   TestLivePolygonIntegration/TestServiceFetchSymbolDetails
2025/10/29 19:10:23 [POLYGON] Using API key: PjP...v0f
    live_integration_test.go:266: ✅ NVDA details: Nvidia Corp, Current Price: $207.04, Market Cap: $4894477410000.00
=== RUN   TestLivePolygonIntegration/TestServiceFetchDividendHistory
2025/10/29 19:10:23 [POLYGON] Using API key: PjP...v0f
    live_integration_test.go:289: ✅ JNJ recent dividend: $1.300 (Ex-Date: 2025-11-25, Pay Date: 2025-12-09)
=== NAME  TestLivePolygonIntegration
    live_integration_test.go:296: ⏱️  Respecting API rate limits (free tier: 5 requests/minute)
--- PASS: TestLivePolygonIntegration (0.69s)
    --- PASS: TestLivePolygonIntegration/TestAPIKeyValidation (0.20s)
    --- PASS: TestLivePolygonIntegration/TestServiceConnection (0.05s)
    --- PASS: TestLivePolygonIntegration/TestGetPreviousClose (0.04s)
    --- SKIP: TestLivePolygonIntegration/TestGetLastQuote (0.04s)
    --- PASS: TestLivePolygonIntegration/TestGetTickerDetails (0.04s)
    --- PASS: TestLivePolygonIntegration/TestGetDividends (0.06s)
    --- PASS: TestLivePolygonIntegration/TestSpecialCharacterSymbol (0.04s)
    --- PASS: TestLivePolygonIntegration/TestServiceSymbolPriceUpdate (0.04s)
    --- PASS: TestLivePolygonIntegration/TestServiceFetchSymbolDetails (0.08s)
    --- PASS: TestLivePolygonIntegration/TestServiceFetchDividendHistory (0.06s)
PASS
ok  	stonks/internal/polygon	1.373s
?   	stonks/internal/web	[no test files]
2025/10/29 19:10:23 Starting Wheeler integration tests using Go version go1.25.2
2025/10/29 19:10:24 [MIGRATION] Commission data migration needed - converting per-contract to total commission
2025/10/29 19:10:24 Database backup created: data\backups\integration_test.2025-10-29-19-10-24.db
2025/10/29 19:10:24 [MIGRATION] Pre-migration backup created: data\backups\integration_test.2025-10-29-19-10-24.db
2025/10/29 19:10:24 [MIGRATION] Updated 0 option records with total commission
2025/10/29 19:10:24 [MIGRATION] Commission data migration completed successfully
2025/10/29 19:10:24 [SERVER] Initializing Wheeler web server
2025/10/29 19:10:24 [SERVER] Connecting to database: data\integration_test.db
2025/10/29 19:10:24 [MIGRATION] Commission data migration already completed, skipping
2025/10/29 19:10:24 [SERVER] Database connection established successfully
2025/10/29 19:10:24 [SERVER] Loading HTML templates from: internal\web\templates\*.html
2025/10/29 19:10:24 [SERVER] HTML templates loaded successfully
2025/10/29 19:10:24 [SERVER] Initializing service layers
2025/10/29 19:10:24 [SERVER] All services initialized successfully
2025/10/29 19:10:24 [SERVER] Server creation completed
2025/10/29 19:10:24 [SERVER] Setting up HTTP routes
2025/10/29 19:10:24 [SERVER] Route registered: /static/ -> file server
2025/10/29 19:10:24 [SERVER] Route registered: / -> dashboardHandler
2025/10/29 19:10:24 [SERVER] Route registered: /monthly -> monthlyHandler
2025/10/29 19:10:24 [SERVER] Route registered: /options -> optionsHandler
2025/10/29 19:10:24 [SERVER] Route registered: /all-options -> allOptionsHandler
2025/10/29 19:10:24 [SERVER] Route registered: /treasuries -> treasuriesHandler
2025/10/29 19:10:24 [SERVER] Route registered: /dividends -> dividendsHandler
2025/10/29 19:10:24 [SERVER] Route registered: /metrics -> metricsHandler
2025/10/29 19:10:24 [SERVER] Route registered: /zen -> zenHandler
2025/10/29 19:10:24 [SERVER] Route registered: /symbol/ -> symbolHandler
2025/10/29 19:10:24 [SERVER] Route registered: /api/premium-data -> premiumDataHandler
2025/10/29 19:10:24 [SERVER] Route registered: /api/options -> optionAPIHandler
2025/10/29 19:10:24 [SERVER] Route registered: /api/options/ -> individualOptionAPIHandler
2025/10/29 19:10:24 [SERVER] Route registered: /api/options/filter -> optionsFilterHandler
2025/10/29 19:10:24 [SERVER] Route registered: /api/symbols/ -> symbolAPIHandler
2025/10/29 19:10:24 [SERVER] Route registered: /api/dividends -> dividendsAPIHandler
2025/10/29 19:10:24 [SERVER] Route registered: /api/long-positions -> longPositionsAPIHandler
2025/10/29 19:10:24 [SERVER] Route registered: /api/treasuries/ -> treasuryAPIHandler
2025/10/29 19:10:24 [SERVER] Route registered: /api/metrics -> metrics API handler
2025/10/29 19:10:24 [SERVER] Route registered: /api/metrics/ -> individual metric API handler
2025/10/29 19:10:24 [SERVER] Route registered: /api/metrics/snapshot -> createMetricsSnapshotHandler
2025/10/29 19:10:24 [SERVER] Route registered: /api/metrics/chart-data -> getMetricsChartDataHandler
2025/10/29 19:10:24 [SERVER] Route registered: /add-option -> addOptionHandler
2025/10/29 19:10:24 [SERVER] Route registered: /add-treasury -> addTreasuryHandler
2025/10/29 19:10:24 [SERVER] Route registered: /api/allocation-data -> allocationDataHandler
2025/10/29 19:10:24 [SERVER] Route registered: /api/optionable-positions -> optionablePositionsHandler
2025/10/29 19:10:24 [SERVER] Route registered: /import -> HandleImport
2025/10/29 19:10:24 [SERVER] Route registered: /backup -> HandleBackup
2025/10/29 19:10:24 [SERVER] Route registered: /backup/ -> HandleBackupFile
2025/10/29 19:10:24 [SERVER] Route registered: /database/set-current -> handleSetCurrentDatabase
2025/10/29 19:10:24 [SERVER] Route registered: /database/create -> handleCreateDatabase
2025/10/29 19:10:24 [SERVER] Route registered: /database/delete/ -> handleDeleteDatabase
2025/10/29 19:10:24 [SERVER] Route registered: /backups/ -> file server for backup directory
2025/10/29 19:10:24 [SERVER] Route registered: /import/upload -> HandleImportUpload
2025/10/29 19:10:24 [SERVER] Route registered: /import/upload/stocks -> HandleStocksImportUpload
2025/10/29 19:10:24 [SERVER] Route registered: /import/upload/dividends -> HandleDividendsImportUpload
2025/10/29 19:10:24 [SERVER] Route registered: /import/upload/treasuries -> HandleTreasuriesImportUpload
2025/10/29 19:10:24 [SERVER] Route registered: /api/generate-test-data -> HandleGenerateTestData
2025/10/29 19:10:24 [SERVER] Route registered: /help -> helpHandler
2025/10/29 19:10:24 [SERVER] Route registered: /settings -> settingsHandler
2025/10/29 19:10:24 [SERVER] Route registered: /api/settings -> settingsAPIHandler
2025/10/29 19:10:24 [SERVER] Route registered: /api/settings/ -> individualSettingAPIHandler
2025/10/29 19:10:24 [SERVER] Route registered: /api/polygon/test -> polygonTestHandler
2025/10/29 19:10:24 [SERVER] Route registered: /api/polygon/update-prices -> polygonUpdatePricesHandler
2025/10/29 19:10:24 [SERVER] Route registered: /api/polygon/symbol-info/ -> polygonSymbolInfoHandler
2025/10/29 19:10:24 [SERVER] Route registered: /api/polygon/status -> polygonStatusHandler
2025/10/29 19:10:24 [SERVER] Route registered: /api/polygon/fetch-dividends -> polygonFetchDividendsHandler
2025/10/29 19:10:24 [SERVER] All routes registered successfully
2025/10/29 19:10:24 Starting test server on localhost:8081
2025/10/29 19:10:24 [DASHBOARD] Found 0 symbols for navigation: []
2025/10/29 19:10:24 [TREASURY SERVICE] GetAll: Starting to retrieve all treasuries
2025/10/29 19:10:24 [TREASURY SERVICE] GetAll: Executing SQL query
2025/10/29 19:10:24 [TREASURY SERVICE] GetAll: SQL = SELECT cuspid, purchased, maturity, amount, yield, buy_price, current_value, exit_price, created_at, updated_at 
			  FROM treasuries ORDER BY maturity DESC, purchased DESC
2025/10/29 19:10:24 [TREASURY SERVICE] GetAll: Successfully retrieved 0 treasuries
2025/10/29 19:10:24 [DASHBOARD] Building dashboard data with 0 symbols: []
2025/10/29 19:10:24 [DASHBOARD] Built 0 symbol summaries
2025/10/29 19:10:24 [TEMPLATE] Starting template execution for: dashboard.html
2025/10/29 19:10:24 [TEMPLATE] Successfully rendered template: dashboard.html
2025/10/29 19:10:24 Test server is ready
=== RUN   TestAllPageRendering
=== RUN   TestAllPageRendering/Dashboard
2025/10/29 19:10:24 [DASHBOARD] Found 0 symbols for navigation: []
2025/10/29 19:10:24 [TREASURY SERVICE] GetAll: Starting to retrieve all treasuries
2025/10/29 19:10:24 [TREASURY SERVICE] GetAll: Executing SQL query
2025/10/29 19:10:24 [TREASURY SERVICE] GetAll: SQL = SELECT cuspid, purchased, maturity, amount, yield, buy_price, current_value, exit_price, created_at, updated_at 
			  FROM treasuries ORDER BY maturity DESC, purchased DESC
2025/10/29 19:10:24 [TREASURY SERVICE] GetAll: Successfully retrieved 0 treasuries
2025/10/29 19:10:24 [DASHBOARD] Building dashboard data with 0 symbols: []
2025/10/29 19:10:24 [DASHBOARD] Built 0 symbol summaries
2025/10/29 19:10:24 [TEMPLATE] Starting template execution for: dashboard.html
2025/10/29 19:10:24 [TEMPLATE] Successfully rendered template: dashboard.html
    all_pages_test.go:82: ✅ Dashboard page rendered successfully
=== RUN   TestAllPageRendering/Monthly
2025/10/29 19:10:24 [TEMPLATE] Starting template execution for: monthly.html
2025/10/29 19:10:24 [TEMPLATE] Successfully rendered template: monthly.html
    all_pages_test.go:82: ✅ Monthly page rendered successfully
=== RUN   TestAllPageRendering/Options
2025/10/29 19:10:24 [OPTIONS PAGE] GET /options - Start processing options page request
2025/10/29 19:10:24 [OPTIONS PAGE] Retrieved 0 symbols for navigation
2025/10/29 19:10:24 [OPTIONS PAGE] Fetching options summary data
2025/10/29 19:10:24 [OPTIONS PAGE] Retrieved 0 options summaries
2025/10/29 19:10:24 [OPTIONS PAGE] Fetching open positions data
2025/10/29 19:10:24 [OPTIONS PAGE] Retrieved 0 open positions
2025/10/29 19:10:24 [OPTIONS PAGE] Calculating summary totals
2025/10/29 19:10:24 [OPTIONS PAGE] ERROR: Failed to get summary totals: failed to get options summary totals: sql: Scan error on column index 1, name "put_positions": converting NULL to int is unsupported
2025/10/29 19:10:24 [OPTIONS PAGE] Rendering options.html template with 0 summaries and 0 open positions
2025/10/29 19:10:24 [TEMPLATE] Starting template execution for: options.html
2025/10/29 19:10:24 [TEMPLATE] Successfully rendered template: options.html
2025/10/29 19:10:24 [OPTIONS PAGE] Successfully completed options page request
    all_pages_test.go:82: ✅ Options page rendered successfully
=== RUN   TestAllPageRendering/Treasuries
2025/10/29 19:10:24 [TREASURIES PAGE] GET /treasuries - Start processing treasuries page request
2025/10/29 19:10:24 [TREASURIES PAGE] Retrieved 0 symbols for navigation
2025/10/29 19:10:24 [TREASURIES PAGE] Fetching all treasuries from service
2025/10/29 19:10:24 [TREASURY SERVICE] GetAll: Starting to retrieve all treasuries
2025/10/29 19:10:24 [TREASURY SERVICE] GetAll: Executing SQL query
2025/10/29 19:10:24 [TREASURY SERVICE] GetAll: SQL = SELECT cuspid, purchased, maturity, amount, yield, buy_price, current_value, exit_price, created_at, updated_at 
			  FROM treasuries ORDER BY maturity DESC, purchased DESC
2025/10/29 19:10:24 [TREASURY SERVICE] GetAll: Successfully retrieved 0 treasuries
2025/10/29 19:10:24 [TREASURIES PAGE] Retrieved 0 treasuries from service
2025/10/29 19:10:24 [TREASURIES PAGE] Calculating summary data for 0 treasuries
2025/10/29 19:10:24 [TREASURIES PAGE] Summary calculated: TotalAmount=0.00, ActivePositions=0
2025/10/29 19:10:24 [TREASURIES PAGE] Rendering treasuries.html template with 0 treasuries
2025/10/29 19:10:24 [TEMPLATE] Starting template execution for: treasuries.html
2025/10/29 19:10:24 [TEMPLATE] Successfully rendered template: treasuries.html
2025/10/29 19:10:24 [TREASURIES PAGE] Successfully completed treasuries page request
    all_pages_test.go:82: ✅ Treasuries page rendered successfully
=== RUN   TestAllPageRendering/Metrics
2025/10/29 19:10:24 [METRICS PAGE] GET /metrics - Start processing metrics page request
2025/10/29 19:10:24 [METRICS PAGE] Retrieved 0 symbols for navigation
2025/10/29 19:10:24 [METRICS PAGE] Fetching all metrics
2025/10/29 19:10:24 [METRICS PAGE] Retrieved 0 metrics
2025/10/29 19:10:24 [METRICS PAGE] Rendering template with 0 metrics
2025/10/29 19:10:24 [METRICS PAGE] GET /metrics - Successfully served metrics page
    all_pages_test.go:82: ✅ Metrics page rendered successfully
=== RUN   TestAllPageRendering/Help
2025/10/29 19:10:24 [HANDLER] Processing Help page request
2025/10/29 19:10:24 [HANDLER] Rendering Help page template with 0 symbols
2025/10/29 19:10:24 [TEMPLATE] Starting template execution for: help.html
2025/10/29 19:10:24 [TEMPLATE] Successfully rendered template: help.html
    all_pages_test.go:82: ✅ Help page rendered successfully
=== RUN   TestAllPageRendering/Settings
2025/10/29 19:10:24 [SETTINGS] Handling settings page request
2025/10/29 19:10:24 [TEMPLATE] Starting template execution for: settings.html
2025/10/29 19:10:24 [TEMPLATE] Successfully rendered template: settings.html
    all_pages_test.go:82: ✅ Settings page rendered successfully
=== RUN   TestAllPageRendering/Import
2025/10/29 19:10:24 [IMPORT] Rendering import page
2025/10/29 19:10:24 [TEMPLATE] Starting template execution for: import.html
2025/10/29 19:10:24 [TEMPLATE] Successfully rendered template: import.html
    all_pages_test.go:82: ✅ Import page rendered successfully
=== RUN   TestAllPageRendering/Backup
2025/10/29 19:10:24 [BACKUP] Rendering backup page
    all_pages_test.go:82: ✅ Backup page rendered successfully
--- PASS: TestAllPageRendering (0.02s)
    --- PASS: TestAllPageRendering/Dashboard (0.00s)
    --- PASS: TestAllPageRendering/Monthly (0.00s)
    --- PASS: TestAllPageRendering/Options (0.00s)
    --- PASS: TestAllPageRendering/Treasuries (0.00s)
    --- PASS: TestAllPageRendering/Metrics (0.00s)
    --- PASS: TestAllPageRendering/Help (0.00s)
    --- PASS: TestAllPageRendering/Settings (0.00s)
    --- PASS: TestAllPageRendering/Import (0.00s)
    --- PASS: TestAllPageRendering/Backup (0.00s)
=== RUN   TestSymbolPagesRendering
=== RUN   TestSymbolPagesRendering/Symbol_AAPL
2025/10/29 19:10:24 [SYMBOL] ===== Starting symbol handler for: AAPL =====
2025/10/29 19:10:24 [SYMBOL] Step 1: Getting all symbols from database
2025/10/29 19:10:24 [SYMBOL] Successfully retrieved 0 symbols: []
2025/10/29 19:10:24 [SYMBOL] Step 2: Getting symbol data for AAPL
2025/10/29 19:10:24 [SYMBOL] ERROR: No symbol data found for AAPL, error: symbol not found
2025/10/29 19:10:24 [SYMBOL] Step 3: Getting dividends for AAPL
2025/10/29 19:10:24 [SYMBOL] Retrieved 0 dividends for AAPL
2025/10/29 19:10:24 [SYMBOL] Total dividends for AAPL: $0.00
2025/10/29 19:10:24 [SYMBOL] Step 4: Getting options for AAPL
2025/10/29 19:10:24 [SYMBOL] Retrieved 0 options for AAPL
2025/10/29 19:10:24 [SYMBOL] Sorted 0 options for AAPL (open positions first)
2025/10/29 19:10:24 [SYMBOL] Step 5: Getting long positions for AAPL
2025/10/29 19:10:24 [SYMBOL] Retrieved 0 long positions for AAPL
2025/10/29 19:10:24 [SYMBOL] Step 6: Calculating options gains for AAPL
2025/10/29 19:10:24 [SYMBOL] Total options gains for AAPL: $0.00 (0 total options)
2025/10/29 19:10:24 [SYMBOL] Step 6b: Calculating total commissions for AAPL
2025/10/29 19:10:24 [SYMBOL] Total commissions for AAPL: $0.00
2025/10/29 19:10:24 [SYMBOL] Step 7: Calculating cap gains for AAPL
2025/10/29 19:10:24 [SYMBOL] Total cap gains for AAPL: $0.00 (0 closed positions)
2025/10/29 19:10:24 [SYMBOL] Step 8: Calculating total invested for AAPL
2025/10/29 19:10:24 [SYMBOL] Total invested for AAPL: $0.00 (0 positions)
2025/10/29 19:10:24 [SYMBOL] Total profits for AAPL: $0.00 (Options: $0.00 + Cap: $0.00 + Div: $0.00)
2025/10/29 19:10:24 [SYMBOL] Cash on Cash for AAPL: 0.00% (Total Profits: $0.00 / Total Invested: $0.00)
2025/10/29 19:10:24 [SYMBOL] Step 9: Building monthly results for AAPL
2025/10/29 19:10:24 [MONTHLY] Building monthly results for 0 options
2025/10/29 19:10:24 [MONTHLY] Initialized 12 months
2025/10/29 19:10:24 [MONTHLY] Processed 0 options out of 0 total
2025/10/29 19:10:24 [MONTHLY] Built 12 monthly results
2025/10/29 19:10:24 [SYMBOL] Built 12 monthly results for AAPL
2025/10/29 19:10:24 [SYMBOL] Step 10: Creating template data for AAPL
2025/10/29 19:10:24 [SYMBOL] Step 11: Template data created successfully for AAPL
2025/10/29 19:10:24 [SYMBOL] Data summary: Price=0.00, OptionsGains=0.00, CapGains=0.00, Dividends=0.00, TotalProfits=0.00, CashOnCash=0.00%
2025/10/29 19:10:24 [SYMBOL] Data counts: 0 dividends, 0 options, 0 long positions, 12 monthly results
2025/10/29 19:10:24 [SYMBOL] Step 12: Rendering template for AAPL
2025/10/29 19:10:24 [TEMPLATE] Starting template execution for: symbol.html
2025/10/29 19:10:24 [TEMPLATE] Successfully rendered template: symbol.html
2025/10/29 19:10:24 [SYMBOL] ===== Completed symbol handler for: AAPL =====
    all_pages_test.go:132: ✅ Symbol page AAPL rendered successfully
=== RUN   TestSymbolPagesRendering/Symbol_MSFT
2025/10/29 19:10:24 [SYMBOL] ===== Starting symbol handler for: MSFT =====
2025/10/29 19:10:24 [SYMBOL] Step 1: Getting all symbols from database
2025/10/29 19:10:24 [SYMBOL] Successfully retrieved 0 symbols: []
2025/10/29 19:10:24 [SYMBOL] Step 2: Getting symbol data for MSFT
2025/10/29 19:10:24 [SYMBOL] ERROR: No symbol data found for MSFT, error: symbol not found
2025/10/29 19:10:24 [SYMBOL] Step 3: Getting dividends for MSFT
2025/10/29 19:10:24 [SYMBOL] Retrieved 0 dividends for MSFT
2025/10/29 19:10:24 [SYMBOL] Total dividends for MSFT: $0.00
2025/10/29 19:10:24 [SYMBOL] Step 4: Getting options for MSFT
2025/10/29 19:10:24 [SYMBOL] Retrieved 0 options for MSFT
2025/10/29 19:10:24 [SYMBOL] Sorted 0 options for MSFT (open positions first)
2025/10/29 19:10:24 [SYMBOL] Step 5: Getting long positions for MSFT
2025/10/29 19:10:24 [SYMBOL] Retrieved 0 long positions for MSFT
2025/10/29 19:10:24 [SYMBOL] Step 6: Calculating options gains for MSFT
2025/10/29 19:10:24 [SYMBOL] Total options gains for MSFT: $0.00 (0 total options)
2025/10/29 19:10:24 [SYMBOL] Step 6b: Calculating total commissions for MSFT
2025/10/29 19:10:24 [SYMBOL] Total commissions for MSFT: $0.00
2025/10/29 19:10:24 [SYMBOL] Step 7: Calculating cap gains for MSFT
2025/10/29 19:10:24 [SYMBOL] Total cap gains for MSFT: $0.00 (0 closed positions)
2025/10/29 19:10:24 [SYMBOL] Step 8: Calculating total invested for MSFT
2025/10/29 19:10:24 [SYMBOL] Total invested for MSFT: $0.00 (0 positions)
2025/10/29 19:10:24 [SYMBOL] Total profits for MSFT: $0.00 (Options: $0.00 + Cap: $0.00 + Div: $0.00)
2025/10/29 19:10:24 [SYMBOL] Cash on Cash for MSFT: 0.00% (Total Profits: $0.00 / Total Invested: $0.00)
2025/10/29 19:10:24 [SYMBOL] Step 9: Building monthly results for MSFT
2025/10/29 19:10:24 [MONTHLY] Building monthly results for 0 options
2025/10/29 19:10:24 [MONTHLY] Initialized 12 months
2025/10/29 19:10:24 [MONTHLY] Processed 0 options out of 0 total
2025/10/29 19:10:24 [MONTHLY] Built 12 monthly results
2025/10/29 19:10:24 [SYMBOL] Built 12 monthly results for MSFT
2025/10/29 19:10:24 [SYMBOL] Step 10: Creating template data for MSFT
2025/10/29 19:10:24 [SYMBOL] Step 11: Template data created successfully for MSFT
2025/10/29 19:10:24 [SYMBOL] Data summary: Price=0.00, OptionsGains=0.00, CapGains=0.00, Dividends=0.00, TotalProfits=0.00, CashOnCash=0.00%
2025/10/29 19:10:24 [SYMBOL] Data counts: 0 dividends, 0 options, 0 long positions, 12 monthly results
2025/10/29 19:10:24 [SYMBOL] Step 12: Rendering template for MSFT
2025/10/29 19:10:24 [TEMPLATE] Starting template execution for: symbol.html
2025/10/29 19:10:24 [TEMPLATE] Successfully rendered template: symbol.html
2025/10/29 19:10:24 [SYMBOL] ===== Completed symbol handler for: MSFT =====
    all_pages_test.go:132: ✅ Symbol page MSFT rendered successfully
=== RUN   TestSymbolPagesRendering/Symbol_NVDA
2025/10/29 19:10:24 [SYMBOL] ===== Starting symbol handler for: NVDA =====
2025/10/29 19:10:24 [SYMBOL] Step 1: Getting all symbols from database
2025/10/29 19:10:24 [SYMBOL] Successfully retrieved 0 symbols: []
2025/10/29 19:10:24 [SYMBOL] Step 2: Getting symbol data for NVDA
2025/10/29 19:10:24 [SYMBOL] ERROR: No symbol data found for NVDA, error: symbol not found
2025/10/29 19:10:24 [SYMBOL] Step 3: Getting dividends for NVDA
2025/10/29 19:10:24 [SYMBOL] Retrieved 0 dividends for NVDA
2025/10/29 19:10:24 [SYMBOL] Total dividends for NVDA: $0.00
2025/10/29 19:10:24 [SYMBOL] Step 4: Getting options for NVDA
2025/10/29 19:10:24 [SYMBOL] Retrieved 0 options for NVDA
2025/10/29 19:10:24 [SYMBOL] Sorted 0 options for NVDA (open positions first)
2025/10/29 19:10:24 [SYMBOL] Step 5: Getting long positions for NVDA
2025/10/29 19:10:24 [SYMBOL] Retrieved 0 long positions for NVDA
2025/10/29 19:10:24 [SYMBOL] Step 6: Calculating options gains for NVDA
2025/10/29 19:10:24 [SYMBOL] Total options gains for NVDA: $0.00 (0 total options)
2025/10/29 19:10:24 [SYMBOL] Step 6b: Calculating total commissions for NVDA
2025/10/29 19:10:24 [SYMBOL] Total commissions for NVDA: $0.00
2025/10/29 19:10:24 [SYMBOL] Step 7: Calculating cap gains for NVDA
2025/10/29 19:10:24 [SYMBOL] Total cap gains for NVDA: $0.00 (0 closed positions)
2025/10/29 19:10:24 [SYMBOL] Step 8: Calculating total invested for NVDA
2025/10/29 19:10:24 [SYMBOL] Total invested for NVDA: $0.00 (0 positions)
2025/10/29 19:10:24 [SYMBOL] Total profits for NVDA: $0.00 (Options: $0.00 + Cap: $0.00 + Div: $0.00)
2025/10/29 19:10:24 [SYMBOL] Cash on Cash for NVDA: 0.00% (Total Profits: $0.00 / Total Invested: $0.00)
2025/10/29 19:10:24 [SYMBOL] Step 9: Building monthly results for NVDA
2025/10/29 19:10:24 [MONTHLY] Building monthly results for 0 options
2025/10/29 19:10:24 [MONTHLY] Initialized 12 months
2025/10/29 19:10:24 [MONTHLY] Processed 0 options out of 0 total
2025/10/29 19:10:24 [MONTHLY] Built 12 monthly results
2025/10/29 19:10:24 [SYMBOL] Built 12 monthly results for NVDA
2025/10/29 19:10:24 [SYMBOL] Step 10: Creating template data for NVDA
2025/10/29 19:10:24 [SYMBOL] Step 11: Template data created successfully for NVDA
2025/10/29 19:10:24 [SYMBOL] Data summary: Price=0.00, OptionsGains=0.00, CapGains=0.00, Dividends=0.00, TotalProfits=0.00, CashOnCash=0.00%
2025/10/29 19:10:24 [SYMBOL] Data counts: 0 dividends, 0 options, 0 long positions, 12 monthly results
2025/10/29 19:10:24 [SYMBOL] Step 12: Rendering template for NVDA
2025/10/29 19:10:24 [TEMPLATE] Starting template execution for: symbol.html
2025/10/29 19:10:24 [TEMPLATE] Successfully rendered template: symbol.html
2025/10/29 19:10:24 [SYMBOL] ===== Completed symbol handler for: NVDA =====
    all_pages_test.go:132: ✅ Symbol page NVDA rendered successfully
=== RUN   TestSymbolPagesRendering/Symbol_TSLA
2025/10/29 19:10:24 [SYMBOL] ===== Starting symbol handler for: TSLA =====
2025/10/29 19:10:24 [SYMBOL] Step 1: Getting all symbols from database
2025/10/29 19:10:24 [SYMBOL] Successfully retrieved 0 symbols: []
2025/10/29 19:10:24 [SYMBOL] Step 2: Getting symbol data for TSLA
2025/10/29 19:10:24 [SYMBOL] ERROR: No symbol data found for TSLA, error: symbol not found
2025/10/29 19:10:24 [SYMBOL] Step 3: Getting dividends for TSLA
2025/10/29 19:10:24 [SYMBOL] Retrieved 0 dividends for TSLA
2025/10/29 19:10:24 [SYMBOL] Total dividends for TSLA: $0.00
2025/10/29 19:10:24 [SYMBOL] Step 4: Getting options for TSLA
2025/10/29 19:10:24 [SYMBOL] Retrieved 0 options for TSLA
2025/10/29 19:10:24 [SYMBOL] Sorted 0 options for TSLA (open positions first)
2025/10/29 19:10:24 [SYMBOL] Step 5: Getting long positions for TSLA
2025/10/29 19:10:24 [SYMBOL] Retrieved 0 long positions for TSLA
2025/10/29 19:10:24 [SYMBOL] Step 6: Calculating options gains for TSLA
2025/10/29 19:10:24 [SYMBOL] Total options gains for TSLA: $0.00 (0 total options)
2025/10/29 19:10:24 [SYMBOL] Step 6b: Calculating total commissions for TSLA
2025/10/29 19:10:24 [SYMBOL] Total commissions for TSLA: $0.00
2025/10/29 19:10:24 [SYMBOL] Step 7: Calculating cap gains for TSLA
2025/10/29 19:10:24 [SYMBOL] Total cap gains for TSLA: $0.00 (0 closed positions)
2025/10/29 19:10:24 [SYMBOL] Step 8: Calculating total invested for TSLA
2025/10/29 19:10:24 [SYMBOL] Total invested for TSLA: $0.00 (0 positions)
2025/10/29 19:10:24 [SYMBOL] Total profits for TSLA: $0.00 (Options: $0.00 + Cap: $0.00 + Div: $0.00)
2025/10/29 19:10:24 [SYMBOL] Cash on Cash for TSLA: 0.00% (Total Profits: $0.00 / Total Invested: $0.00)
2025/10/29 19:10:24 [SYMBOL] Step 9: Building monthly results for TSLA
2025/10/29 19:10:24 [MONTHLY] Building monthly results for 0 options
2025/10/29 19:10:24 [MONTHLY] Initialized 12 months
2025/10/29 19:10:24 [MONTHLY] Processed 0 options out of 0 total
2025/10/29 19:10:24 [MONTHLY] Built 12 monthly results
2025/10/29 19:10:24 [SYMBOL] Built 12 monthly results for TSLA
2025/10/29 19:10:24 [SYMBOL] Step 10: Creating template data for TSLA
2025/10/29 19:10:24 [SYMBOL] Step 11: Template data created successfully for TSLA
2025/10/29 19:10:24 [SYMBOL] Data summary: Price=0.00, OptionsGains=0.00, CapGains=0.00, Dividends=0.00, TotalProfits=0.00, CashOnCash=0.00%
2025/10/29 19:10:24 [SYMBOL] Data counts: 0 dividends, 0 options, 0 long positions, 12 monthly results
2025/10/29 19:10:24 [SYMBOL] Step 12: Rendering template for TSLA
2025/10/29 19:10:24 [TEMPLATE] Starting template execution for: symbol.html
2025/10/29 19:10:24 [TEMPLATE] Successfully rendered template: symbol.html
2025/10/29 19:10:24 [SYMBOL] ===== Completed symbol handler for: TSLA =====
    all_pages_test.go:132: ✅ Symbol page TSLA rendered successfully
=== RUN   TestSymbolPagesRendering/Symbol_VZ
2025/10/29 19:10:24 [SYMBOL] ===== Starting symbol handler for: VZ =====
2025/10/29 19:10:24 [SYMBOL] Step 1: Getting all symbols from database
2025/10/29 19:10:24 [SYMBOL] Successfully retrieved 0 symbols: []
2025/10/29 19:10:24 [SYMBOL] Step 2: Getting symbol data for VZ
2025/10/29 19:10:24 [SYMBOL] ERROR: No symbol data found for VZ, error: symbol not found
2025/10/29 19:10:24 [SYMBOL] Step 3: Getting dividends for VZ
2025/10/29 19:10:24 [SYMBOL] Retrieved 0 dividends for VZ
2025/10/29 19:10:24 [SYMBOL] Total dividends for VZ: $0.00
2025/10/29 19:10:24 [SYMBOL] Step 4: Getting options for VZ
2025/10/29 19:10:24 [SYMBOL] Retrieved 0 options for VZ
2025/10/29 19:10:24 [SYMBOL] Sorted 0 options for VZ (open positions first)
2025/10/29 19:10:24 [SYMBOL] Step 5: Getting long positions for VZ
2025/10/29 19:10:24 [SYMBOL] Retrieved 0 long positions for VZ
2025/10/29 19:10:24 [SYMBOL] Step 6: Calculating options gains for VZ
2025/10/29 19:10:24 [SYMBOL] Total options gains for VZ: $0.00 (0 total options)
2025/10/29 19:10:24 [SYMBOL] Step 6b: Calculating total commissions for VZ
2025/10/29 19:10:24 [SYMBOL] Total commissions for VZ: $0.00
2025/10/29 19:10:24 [SYMBOL] Step 7: Calculating cap gains for VZ
2025/10/29 19:10:24 [SYMBOL] Total cap gains for VZ: $0.00 (0 closed positions)
2025/10/29 19:10:24 [SYMBOL] Step 8: Calculating total invested for VZ
2025/10/29 19:10:24 [SYMBOL] Total invested for VZ: $0.00 (0 positions)
2025/10/29 19:10:24 [SYMBOL] Total profits for VZ: $0.00 (Options: $0.00 + Cap: $0.00 + Div: $0.00)
2025/10/29 19:10:24 [SYMBOL] Cash on Cash for VZ: 0.00% (Total Profits: $0.00 / Total Invested: $0.00)
2025/10/29 19:10:24 [SYMBOL] Step 9: Building monthly results for VZ
2025/10/29 19:10:24 [MONTHLY] Building monthly results for 0 options
2025/10/29 19:10:24 [MONTHLY] Initialized 12 months
2025/10/29 19:10:24 [MONTHLY] Processed 0 options out of 0 total
2025/10/29 19:10:24 [MONTHLY] Built 12 monthly results
2025/10/29 19:10:24 [SYMBOL] Built 12 monthly results for VZ
2025/10/29 19:10:24 [SYMBOL] Step 10: Creating template data for VZ
2025/10/29 19:10:24 [SYMBOL] Step 11: Template data created successfully for VZ
2025/10/29 19:10:24 [SYMBOL] Data summary: Price=0.00, OptionsGains=0.00, CapGains=0.00, Dividends=0.00, TotalProfits=0.00, CashOnCash=0.00%
2025/10/29 19:10:24 [SYMBOL] Data counts: 0 dividends, 0 options, 0 long positions, 12 monthly results
2025/10/29 19:10:24 [SYMBOL] Step 12: Rendering template for VZ
2025/10/29 19:10:24 [TEMPLATE] Starting template execution for: symbol.html
2025/10/29 19:10:24 [TEMPLATE] Successfully rendered template: symbol.html
2025/10/29 19:10:24 [SYMBOL] ===== Completed symbol handler for: VZ =====
    all_pages_test.go:132: ✅ Symbol page VZ rendered successfully
--- PASS: TestSymbolPagesRendering (0.01s)
    --- PASS: TestSymbolPagesRendering/Symbol_AAPL (0.00s)
    --- PASS: TestSymbolPagesRendering/Symbol_MSFT (0.00s)
    --- PASS: TestSymbolPagesRendering/Symbol_NVDA (0.00s)
    --- PASS: TestSymbolPagesRendering/Symbol_TSLA (0.00s)
    --- PASS: TestSymbolPagesRendering/Symbol_VZ (0.00s)
=== RUN   TestAddFormsRendering
=== RUN   TestAddFormsRendering/AddOption
    all_pages_test.go:192: ✅ AddOption page handled successfully (status: 405)
=== RUN   TestAddFormsRendering/AddTreasury
2025/10/29 19:10:24 [ADD TREASURY] Starting POST request to add new treasury
2025/10/29 19:10:24 [ADD TREASURY] ERROR: Invalid method: GET
    all_pages_test.go:192: ✅ AddTreasury page handled successfully (status: 405)
--- PASS: TestAddFormsRendering (0.00s)
    --- PASS: TestAddFormsRendering/AddOption (0.00s)
    --- PASS: TestAddFormsRendering/AddTreasury (0.00s)
=== RUN   TestAllocationDataHandler
2025/10/29 19:10:24 [MIGRATION] Commission data migration needed - converting per-contract to total commission
2025/10/29 19:10:24 Database backup created: data\backups\test_charts.2025-10-29-19-10-24.db
2025/10/29 19:10:24 [MIGRATION] Pre-migration backup created: data\backups\test_charts.2025-10-29-19-10-24.db
2025/10/29 19:10:24 [MIGRATION] Updated 0 option records with total commission
2025/10/29 19:10:24 [MIGRATION] Commission data migration completed successfully
2025/10/29 19:10:24 [TREASURY SERVICE] Create: Starting creation for CUSPID=TEST-TREASURY-001
2025/10/29 19:10:24 [TREASURY SERVICE] Create: Parameters - Purchased=2024-01-01 00:00:00 +0000 UTC, Maturity=2025-01-01 00:00:00 +0000 UTC, Amount=50000.00, Yield=4.500, BuyPrice=50000.00
2025/10/29 19:10:24 [TREASURY SERVICE] Create: Executing SQL query for CUSPID=TEST-TREASURY-001
2025/10/29 19:10:24 [TREASURY SERVICE] Create: SQL = INSERT INTO treasuries (cuspid, purchased, maturity, amount, yield, buy_price) 
			  VALUES (?, ?, ?, ?, ?, ?) 
			  RETURNING cuspid, purchased, maturity, amount, yield, buy_price, current_value, exit_price, created_at, updated_at
2025/10/29 19:10:24 [TREASURY SERVICE] Create: Successfully created treasury for CUSPID=TEST-TREASURY-001
2025/10/29 19:10:24 [TREASURY SERVICE] Create: Created treasury data - Amount=50000.00, Yield=4.500, BuyPrice=50000.00, CreatedAt=2025-10-30 00:10:24 +0000 UTC
    chart_handlers_test.go:493: ✅ Created deterministic test data for charts
    chart_handlers_test.go:121: ✅ AllocationData test passed - found 2 long positions, 2 put exposures
--- PASS: TestAllocationDataHandler (0.30s)
=== RUN   TestMetricsChartDataHandler
2025/10/29 19:10:24 [MIGRATION] Commission data migration needed - converting per-contract to total commission
2025/10/29 19:10:24 Database backup created: data\backups\test_metrics.2025-10-29-19-10-24.db
2025/10/29 19:10:24 [MIGRATION] Pre-migration backup created: data\backups\test_metrics.2025-10-29-19-10-24.db
2025/10/29 19:10:24 [MIGRATION] Updated 0 option records with total commission
2025/10/29 19:10:24 [MIGRATION] Commission data migration completed successfully
    chart_handlers_test.go:539: ✅ Created deterministic metrics data for 30 days
    chart_handlers_test.go:189: ✅ Metric 'put_exposure' has 3 data points
    chart_handlers_test.go:189: ✅ Metric 'open_put_premium' has 3 data points
    chart_handlers_test.go:189: ✅ Metric 'open_put_count' has 3 data points
    chart_handlers_test.go:189: ✅ Metric 'long_value' has 3 data points
    chart_handlers_test.go:189: ✅ Metric 'open_call_premium' has 3 data points
    chart_handlers_test.go:189: ✅ Metric 'open_call_count' has 3 data points
    chart_handlers_test.go:189: ✅ Metric 'treasury_value' has 3 data points
    chart_handlers_test.go:192: ✅ MetricsChartData test passed - validated 7 metric types
--- PASS: TestMetricsChartDataHandler (0.34s)
=== RUN   TestOptionsScatterDataStructure
    chart_handlers_test.go:284: ✅ OptionsScatterData struct validation passed
--- PASS: TestOptionsScatterDataStructure (0.00s)
=== RUN   TestTutorialChartDataStructure
    chart_handlers_test.go:383: ✅ TutorialChartData struct validation passed - Total: $34151.50, ROI: 73.4%
--- PASS: TestTutorialChartDataStructure (0.00s)
=== RUN   TestAllChartStructuresComprehensive
=== RUN   TestAllChartStructuresComprehensive/Dashboard_Charts
2025/10/29 19:10:25 [MIGRATION] Commission data migration needed - converting per-contract to total commission
2025/10/29 19:10:25 Database backup created: data\backups\test_comprehensive.2025-10-29-19-10-25.db
2025/10/29 19:10:25 [MIGRATION] Pre-migration backup created: data\backups\test_comprehensive.2025-10-29-19-10-25.db
2025/10/29 19:10:25 [MIGRATION] Updated 0 option records with total commission
2025/10/29 19:10:25 [MIGRATION] Commission data migration completed successfully
2025/10/29 19:10:25 [TREASURY SERVICE] Create: Starting creation for CUSPID=TREASURY-001
2025/10/29 19:10:25 [TREASURY SERVICE] Create: Parameters - Purchased=2023-12-01 00:00:00 +0000 UTC, Maturity=2024-12-01 00:00:00 +0000 UTC, Amount=50000.00, Yield=4.000, BuyPrice=49750.00
2025/10/29 19:10:25 [TREASURY SERVICE] Create: Executing SQL query for CUSPID=TREASURY-001
2025/10/29 19:10:25 [TREASURY SERVICE] Create: SQL = INSERT INTO treasuries (cuspid, purchased, maturity, amount, yield, buy_price) 
			  VALUES (?, ?, ?, ?, ?, ?) 
			  RETURNING cuspid, purchased, maturity, amount, yield, buy_price, current_value, exit_price, created_at, updated_at
2025/10/29 19:10:25 [TREASURY SERVICE] Create: Successfully created treasury for CUSPID=TREASURY-001
2025/10/29 19:10:25 [TREASURY SERVICE] Create: Created treasury data - Amount=50000.00, Yield=4.000, BuyPrice=49750.00, CreatedAt=2025-10-30 00:10:25 +0000 UTC
2025/10/29 19:10:25 [TREASURY SERVICE] Create: Starting creation for CUSPID=TREASURY-002
2025/10/29 19:10:25 [TREASURY SERVICE] Create: Parameters - Purchased=2024-04-01 00:00:00 +0000 UTC, Maturity=2025-04-01 00:00:00 +0000 UTC, Amount=60000.00, Yield=4.400, BuyPrice=59700.00
2025/10/29 19:10:25 [TREASURY SERVICE] Create: Executing SQL query for CUSPID=TREASURY-002
2025/10/29 19:10:25 [TREASURY SERVICE] Create: SQL = INSERT INTO treasuries (cuspid, purchased, maturity, amount, yield, buy_price) 
			  VALUES (?, ?, ?, ?, ?, ?) 
			  RETURNING cuspid, purchased, maturity, amount, yield, buy_price, current_value, exit_price, created_at, updated_at
2025/10/29 19:10:25 [TREASURY SERVICE] Create: Successfully created treasury for CUSPID=TREASURY-002
2025/10/29 19:10:25 [TREASURY SERVICE] Create: Created treasury data - Amount=60000.00, Yield=4.400, BuyPrice=59700.00, CreatedAt=2025-10-30 00:10:25 +0000 UTC
2025/10/29 19:10:25 [TREASURY SERVICE] Create: Starting creation for CUSPID=TREASURY-003
2025/10/29 19:10:25 [TREASURY SERVICE] Create: Parameters - Purchased=2024-08-01 00:00:00 +0000 UTC, Maturity=2025-08-01 00:00:00 +0000 UTC, Amount=70000.00, Yield=4.800, BuyPrice=69650.00
2025/10/29 19:10:25 [TREASURY SERVICE] Create: Executing SQL query for CUSPID=TREASURY-003
2025/10/29 19:10:25 [TREASURY SERVICE] Create: SQL = INSERT INTO treasuries (cuspid, purchased, maturity, amount, yield, buy_price) 
			  VALUES (?, ?, ?, ?, ?, ?) 
			  RETURNING cuspid, purchased, maturity, amount, yield, buy_price, current_value, exit_price, created_at, updated_at
2025/10/29 19:10:25 [TREASURY SERVICE] Create: Successfully created treasury for CUSPID=TREASURY-003
2025/10/29 19:10:25 [TREASURY SERVICE] Create: Created treasury data - Amount=70000.00, Yield=4.800, BuyPrice=69650.00, CreatedAt=2025-10-30 00:10:25 +0000 UTC
    comprehensive_charts_test.go:383: ✅ Created comprehensive test data for 5 symbols over 12 months
    comprehensive_charts_test.go:459: ✅ AllocationData validated: 5 long, 3 puts, 3 total
=== RUN   TestAllChartStructuresComprehensive/Monthly_Charts
2025/10/29 19:10:25 [MIGRATION] Commission data migration needed - converting per-contract to total commission
2025/10/29 19:10:25 Database backup created: data\backups\test_comprehensive.2025-10-29-19-10-25.db
2025/10/29 19:10:25 [MIGRATION] Pre-migration backup created: data\backups\test_comprehensive.2025-10-29-19-10-25.db
2025/10/29 19:10:25 [MIGRATION] Updated 0 option records with total commission
2025/10/29 19:10:25 [MIGRATION] Commission data migration completed successfully
2025/10/29 19:10:25 [TREASURY SERVICE] Create: Starting creation for CUSPID=TREASURY-001
2025/10/29 19:10:25 [TREASURY SERVICE] Create: Parameters - Purchased=2023-12-01 00:00:00 +0000 UTC, Maturity=2024-12-01 00:00:00 +0000 UTC, Amount=50000.00, Yield=4.000, BuyPrice=49750.00
2025/10/29 19:10:25 [TREASURY SERVICE] Create: Executing SQL query for CUSPID=TREASURY-001
2025/10/29 19:10:25 [TREASURY SERVICE] Create: SQL = INSERT INTO treasuries (cuspid, purchased, maturity, amount, yield, buy_price) 
			  VALUES (?, ?, ?, ?, ?, ?) 
			  RETURNING cuspid, purchased, maturity, amount, yield, buy_price, current_value, exit_price, created_at, updated_at
2025/10/29 19:10:25 [TREASURY SERVICE] Create: Successfully created treasury for CUSPID=TREASURY-001
2025/10/29 19:10:25 [TREASURY SERVICE] Create: Created treasury data - Amount=50000.00, Yield=4.000, BuyPrice=49750.00, CreatedAt=2025-10-30 00:10:25 +0000 UTC
2025/10/29 19:10:25 [TREASURY SERVICE] Create: Starting creation for CUSPID=TREASURY-002
2025/10/29 19:10:25 [TREASURY SERVICE] Create: Parameters - Purchased=2024-04-01 00:00:00 +0000 UTC, Maturity=2025-04-01 00:00:00 +0000 UTC, Amount=60000.00, Yield=4.400, BuyPrice=59700.00
2025/10/29 19:10:25 [TREASURY SERVICE] Create: Executing SQL query for CUSPID=TREASURY-002
2025/10/29 19:10:25 [TREASURY SERVICE] Create: SQL = INSERT INTO treasuries (cuspid, purchased, maturity, amount, yield, buy_price) 
			  VALUES (?, ?, ?, ?, ?, ?) 
			  RETURNING cuspid, purchased, maturity, amount, yield, buy_price, current_value, exit_price, created_at, updated_at
2025/10/29 19:10:25 [TREASURY SERVICE] Create: Successfully created treasury for CUSPID=TREASURY-002
2025/10/29 19:10:25 [TREASURY SERVICE] Create: Created treasury data - Amount=60000.00, Yield=4.400, BuyPrice=59700.00, CreatedAt=2025-10-30 00:10:25 +0000 UTC
2025/10/29 19:10:25 [TREASURY SERVICE] Create: Starting creation for CUSPID=TREASURY-003
2025/10/29 19:10:25 [TREASURY SERVICE] Create: Parameters - Purchased=2024-08-01 00:00:00 +0000 UTC, Maturity=2025-08-01 00:00:00 +0000 UTC, Amount=70000.00, Yield=4.800, BuyPrice=69650.00
2025/10/29 19:10:25 [TREASURY SERVICE] Create: Executing SQL query for CUSPID=TREASURY-003
2025/10/29 19:10:25 [TREASURY SERVICE] Create: SQL = INSERT INTO treasuries (cuspid, purchased, maturity, amount, yield, buy_price) 
			  VALUES (?, ?, ?, ?, ?, ?) 
			  RETURNING cuspid, purchased, maturity, amount, yield, buy_price, current_value, exit_price, created_at, updated_at
2025/10/29 19:10:25 [TREASURY SERVICE] Create: Successfully created treasury for CUSPID=TREASURY-003
2025/10/29 19:10:25 [TREASURY SERVICE] Create: Created treasury data - Amount=70000.00, Yield=4.800, BuyPrice=69650.00, CreatedAt=2025-10-30 00:10:25 +0000 UTC
    comprehensive_charts_test.go:383: ✅ Created comprehensive test data for 5 symbols over 12 months
    comprehensive_charts_test.go:473: ✅ MonthlyData validated: 6 months puts, 3 months calls
=== RUN   TestAllChartStructuresComprehensive/Symbol_Charts
2025/10/29 19:10:26 [MIGRATION] Commission data migration needed - converting per-contract to total commission
2025/10/29 19:10:26 Database backup created: data\backups\test_comprehensive.2025-10-29-19-10-26.db
2025/10/29 19:10:26 [MIGRATION] Pre-migration backup created: data\backups\test_comprehensive.2025-10-29-19-10-26.db
2025/10/29 19:10:26 [MIGRATION] Updated 0 option records with total commission
2025/10/29 19:10:26 [MIGRATION] Commission data migration completed successfully
2025/10/29 19:10:26 [TREASURY SERVICE] Create: Starting creation for CUSPID=TREASURY-001
2025/10/29 19:10:26 [TREASURY SERVICE] Create: Parameters - Purchased=2023-12-01 00:00:00 +0000 UTC, Maturity=2024-12-01 00:00:00 +0000 UTC, Amount=50000.00, Yield=4.000, BuyPrice=49750.00
2025/10/29 19:10:26 [TREASURY SERVICE] Create: Executing SQL query for CUSPID=TREASURY-001
2025/10/29 19:10:26 [TREASURY SERVICE] Create: SQL = INSERT INTO treasuries (cuspid, purchased, maturity, amount, yield, buy_price) 
			  VALUES (?, ?, ?, ?, ?, ?) 
			  RETURNING cuspid, purchased, maturity, amount, yield, buy_price, current_value, exit_price, created_at, updated_at
2025/10/29 19:10:26 [TREASURY SERVICE] Create: Successfully created treasury for CUSPID=TREASURY-001
2025/10/29 19:10:26 [TREASURY SERVICE] Create: Created treasury data - Amount=50000.00, Yield=4.000, BuyPrice=49750.00, CreatedAt=2025-10-30 00:10:26 +0000 UTC
2025/10/29 19:10:26 [TREASURY SERVICE] Create: Starting creation for CUSPID=TREASURY-002
2025/10/29 19:10:26 [TREASURY SERVICE] Create: Parameters - Purchased=2024-04-01 00:00:00 +0000 UTC, Maturity=2025-04-01 00:00:00 +0000 UTC, Amount=60000.00, Yield=4.400, BuyPrice=59700.00
2025/10/29 19:10:26 [TREASURY SERVICE] Create: Executing SQL query for CUSPID=TREASURY-002
2025/10/29 19:10:26 [TREASURY SERVICE] Create: SQL = INSERT INTO treasuries (cuspid, purchased, maturity, amount, yield, buy_price) 
			  VALUES (?, ?, ?, ?, ?, ?) 
			  RETURNING cuspid, purchased, maturity, amount, yield, buy_price, current_value, exit_price, created_at, updated_at
2025/10/29 19:10:26 [TREASURY SERVICE] Create: Successfully created treasury for CUSPID=TREASURY-002
2025/10/29 19:10:26 [TREASURY SERVICE] Create: Created treasury data - Amount=60000.00, Yield=4.400, BuyPrice=59700.00, CreatedAt=2025-10-30 00:10:26 +0000 UTC
2025/10/29 19:10:26 [TREASURY SERVICE] Create: Starting creation for CUSPID=TREASURY-003
2025/10/29 19:10:26 [TREASURY SERVICE] Create: Parameters - Purchased=2024-08-01 00:00:00 +0000 UTC, Maturity=2025-08-01 00:00:00 +0000 UTC, Amount=70000.00, Yield=4.800, BuyPrice=69650.00
2025/10/29 19:10:26 [TREASURY SERVICE] Create: Executing SQL query for CUSPID=TREASURY-003
2025/10/29 19:10:26 [TREASURY SERVICE] Create: SQL = INSERT INTO treasuries (cuspid, purchased, maturity, amount, yield, buy_price) 
			  VALUES (?, ?, ?, ?, ?, ?) 
			  RETURNING cuspid, purchased, maturity, amount, yield, buy_price, current_value, exit_price, created_at, updated_at
2025/10/29 19:10:26 [TREASURY SERVICE] Create: Successfully created treasury for CUSPID=TREASURY-003
2025/10/29 19:10:26 [TREASURY SERVICE] Create: Created treasury data - Amount=70000.00, Yield=4.800, BuyPrice=69650.00, CreatedAt=2025-10-30 00:10:26 +0000 UTC
    comprehensive_charts_test.go:383: ✅ Created comprehensive test data for 5 symbols over 12 months
    comprehensive_charts_test.go:484: ✅ SymbolData validated: AAPL with 3 monthly results
=== RUN   TestAllChartStructuresComprehensive/Metrics_Charts
2025/10/29 19:10:26 [MIGRATION] Commission data migration needed - converting per-contract to total commission
2025/10/29 19:10:26 Database backup created: data\backups\test_comprehensive.2025-10-29-19-10-26.db
2025/10/29 19:10:26 [MIGRATION] Pre-migration backup created: data\backups\test_comprehensive.2025-10-29-19-10-26.db
2025/10/29 19:10:26 [MIGRATION] Updated 0 option records with total commission
2025/10/29 19:10:26 [MIGRATION] Commission data migration completed successfully
2025/10/29 19:10:26 [TREASURY SERVICE] Create: Starting creation for CUSPID=TREASURY-001
2025/10/29 19:10:26 [TREASURY SERVICE] Create: Parameters - Purchased=2023-12-01 00:00:00 +0000 UTC, Maturity=2024-12-01 00:00:00 +0000 UTC, Amount=50000.00, Yield=4.000, BuyPrice=49750.00
2025/10/29 19:10:26 [TREASURY SERVICE] Create: Executing SQL query for CUSPID=TREASURY-001
2025/10/29 19:10:26 [TREASURY SERVICE] Create: SQL = INSERT INTO treasuries (cuspid, purchased, maturity, amount, yield, buy_price) 
			  VALUES (?, ?, ?, ?, ?, ?) 
			  RETURNING cuspid, purchased, maturity, amount, yield, buy_price, current_value, exit_price, created_at, updated_at
2025/10/29 19:10:26 [TREASURY SERVICE] Create: Successfully created treasury for CUSPID=TREASURY-001
2025/10/29 19:10:26 [TREASURY SERVICE] Create: Created treasury data - Amount=50000.00, Yield=4.000, BuyPrice=49750.00, CreatedAt=2025-10-30 00:10:26 +0000 UTC
2025/10/29 19:10:26 [TREASURY SERVICE] Create: Starting creation for CUSPID=TREASURY-002
2025/10/29 19:10:26 [TREASURY SERVICE] Create: Parameters - Purchased=2024-04-01 00:00:00 +0000 UTC, Maturity=2025-04-01 00:00:00 +0000 UTC, Amount=60000.00, Yield=4.400, BuyPrice=59700.00
2025/10/29 19:10:26 [TREASURY SERVICE] Create: Executing SQL query for CUSPID=TREASURY-002
2025/10/29 19:10:26 [TREASURY SERVICE] Create: SQL = INSERT INTO treasuries (cuspid, purchased, maturity, amount, yield, buy_price) 
			  VALUES (?, ?, ?, ?, ?, ?) 
			  RETURNING cuspid, purchased, maturity, amount, yield, buy_price, current_value, exit_price, created_at, updated_at
2025/10/29 19:10:26 [TREASURY SERVICE] Create: Successfully created treasury for CUSPID=TREASURY-002
2025/10/29 19:10:26 [TREASURY SERVICE] Create: Created treasury data - Amount=60000.00, Yield=4.400, BuyPrice=59700.00, CreatedAt=2025-10-30 00:10:26 +0000 UTC
2025/10/29 19:10:26 [TREASURY SERVICE] Create: Starting creation for CUSPID=TREASURY-003
2025/10/29 19:10:26 [TREASURY SERVICE] Create: Parameters - Purchased=2024-08-01 00:00:00 +0000 UTC, Maturity=2025-08-01 00:00:00 +0000 UTC, Amount=70000.00, Yield=4.800, BuyPrice=69650.00
2025/10/29 19:10:26 [TREASURY SERVICE] Create: Executing SQL query for CUSPID=TREASURY-003
2025/10/29 19:10:26 [TREASURY SERVICE] Create: SQL = INSERT INTO treasuries (cuspid, purchased, maturity, amount, yield, buy_price) 
			  VALUES (?, ?, ?, ?, ?, ?) 
			  RETURNING cuspid, purchased, maturity, amount, yield, buy_price, current_value, exit_price, created_at, updated_at
2025/10/29 19:10:26 [TREASURY SERVICE] Create: Successfully created treasury for CUSPID=TREASURY-003
2025/10/29 19:10:26 [TREASURY SERVICE] Create: Created treasury data - Amount=70000.00, Yield=4.800, BuyPrice=69650.00, CreatedAt=2025-10-30 00:10:26 +0000 UTC
    comprehensive_charts_test.go:383: ✅ Created comprehensive test data for 5 symbols over 12 months
    comprehensive_charts_test.go:495: ✅ MetricsData validated: 5 metric types
=== RUN   TestAllChartStructuresComprehensive/Options_Scatter_Chart
    comprehensive_charts_test.go:505: ✅ OptionsScatterData validated: 2 points
=== RUN   TestAllChartStructuresComprehensive/Tutorial_Chart
    comprehensive_charts_test.go:515: ✅ TutorialChartData validated: 4 categories, total $38650.00
=== RUN   TestAllChartStructuresComprehensive/Treasury_Charts
2025/10/29 19:10:26 [MIGRATION] Commission data migration needed - converting per-contract to total commission
2025/10/29 19:10:27 Database backup created: data\backups\test_comprehensive.2025-10-29-19-10-26.db
2025/10/29 19:10:27 [MIGRATION] Pre-migration backup created: data\backups\test_comprehensive.2025-10-29-19-10-26.db
2025/10/29 19:10:27 [MIGRATION] Updated 0 option records with total commission
2025/10/29 19:10:27 [MIGRATION] Commission data migration completed successfully
2025/10/29 19:10:27 [TREASURY SERVICE] Create: Starting creation for CUSPID=TREASURY-001
2025/10/29 19:10:27 [TREASURY SERVICE] Create: Parameters - Purchased=2023-12-01 00:00:00 +0000 UTC, Maturity=2024-12-01 00:00:00 +0000 UTC, Amount=50000.00, Yield=4.000, BuyPrice=49750.00
2025/10/29 19:10:27 [TREASURY SERVICE] Create: Executing SQL query for CUSPID=TREASURY-001
2025/10/29 19:10:27 [TREASURY SERVICE] Create: SQL = INSERT INTO treasuries (cuspid, purchased, maturity, amount, yield, buy_price) 
			  VALUES (?, ?, ?, ?, ?, ?) 
			  RETURNING cuspid, purchased, maturity, amount, yield, buy_price, current_value, exit_price, created_at, updated_at
2025/10/29 19:10:27 [TREASURY SERVICE] Create: Successfully created treasury for CUSPID=TREASURY-001
2025/10/29 19:10:27 [TREASURY SERVICE] Create: Created treasury data - Amount=50000.00, Yield=4.000, BuyPrice=49750.00, CreatedAt=2025-10-30 00:10:27 +0000 UTC
2025/10/29 19:10:27 [TREASURY SERVICE] Create: Starting creation for CUSPID=TREASURY-002
2025/10/29 19:10:27 [TREASURY SERVICE] Create: Parameters - Purchased=2024-04-01 00:00:00 +0000 UTC, Maturity=2025-04-01 00:00:00 +0000 UTC, Amount=60000.00, Yield=4.400, BuyPrice=59700.00
2025/10/29 19:10:27 [TREASURY SERVICE] Create: Executing SQL query for CUSPID=TREASURY-002
2025/10/29 19:10:27 [TREASURY SERVICE] Create: SQL = INSERT INTO treasuries (cuspid, purchased, maturity, amount, yield, buy_price) 
			  VALUES (?, ?, ?, ?, ?, ?) 
			  RETURNING cuspid, purchased, maturity, amount, yield, buy_price, current_value, exit_price, created_at, updated_at
2025/10/29 19:10:27 [TREASURY SERVICE] Create: Successfully created treasury for CUSPID=TREASURY-002
2025/10/29 19:10:27 [TREASURY SERVICE] Create: Created treasury data - Amount=60000.00, Yield=4.400, BuyPrice=59700.00, CreatedAt=2025-10-30 00:10:27 +0000 UTC
2025/10/29 19:10:27 [TREASURY SERVICE] Create: Starting creation for CUSPID=TREASURY-003
2025/10/29 19:10:27 [TREASURY SERVICE] Create: Parameters - Purchased=2024-08-01 00:00:00 +0000 UTC, Maturity=2025-08-01 00:00:00 +0000 UTC, Amount=70000.00, Yield=4.800, BuyPrice=69650.00
2025/10/29 19:10:27 [TREASURY SERVICE] Create: Executing SQL query for CUSPID=TREASURY-003
2025/10/29 19:10:27 [TREASURY SERVICE] Create: SQL = INSERT INTO treasuries (cuspid, purchased, maturity, amount, yield, buy_price) 
			  VALUES (?, ?, ?, ?, ?, ?) 
			  RETURNING cuspid, purchased, maturity, amount, yield, buy_price, current_value, exit_price, created_at, updated_at
2025/10/29 19:10:27 [TREASURY SERVICE] Create: Successfully created treasury for CUSPID=TREASURY-003
2025/10/29 19:10:27 [TREASURY SERVICE] Create: Created treasury data - Amount=70000.00, Yield=4.800, BuyPrice=69650.00, CreatedAt=2025-10-30 00:10:27 +0000 UTC
    comprehensive_charts_test.go:383: ✅ Created comprehensive test data for 5 symbols over 12 months
    comprehensive_charts_test.go:526: ✅ TreasuryData validated: 3 treasuries, total $225000.00
--- PASS: TestAllChartStructuresComprehensive (2.44s)
    --- PASS: TestAllChartStructuresComprehensive/Dashboard_Charts (0.58s)
    --- PASS: TestAllChartStructuresComprehensive/Monthly_Charts (0.50s)
    --- PASS: TestAllChartStructuresComprehensive/Symbol_Charts (0.47s)
    --- PASS: TestAllChartStructuresComprehensive/Metrics_Charts (0.45s)
    --- PASS: TestAllChartStructuresComprehensive/Options_Scatter_Chart (0.00s)
    --- PASS: TestAllChartStructuresComprehensive/Tutorial_Chart (0.00s)
    --- PASS: TestAllChartStructuresComprehensive/Treasury_Charts (0.44s)
=== RUN   TestChartDataConsistency
=== RUN   TestChartDataConsistency/ColorConsistency
2025/10/29 19:10:27 [MIGRATION] Commission data migration needed - converting per-contract to total commission
2025/10/29 19:10:27 Database backup created: data\backups\test_comprehensive.2025-10-29-19-10-27.db
2025/10/29 19:10:27 [MIGRATION] Pre-migration backup created: data\backups\test_comprehensive.2025-10-29-19-10-27.db
2025/10/29 19:10:27 [MIGRATION] Updated 0 option records with total commission
2025/10/29 19:10:27 [MIGRATION] Commission data migration completed successfully
2025/10/29 19:10:27 [TREASURY SERVICE] Create: Starting creation for CUSPID=TREASURY-001
2025/10/29 19:10:27 [TREASURY SERVICE] Create: Parameters - Purchased=2023-12-01 00:00:00 +0000 UTC, Maturity=2024-12-01 00:00:00 +0000 UTC, Amount=50000.00, Yield=4.000, BuyPrice=49750.00
2025/10/29 19:10:27 [TREASURY SERVICE] Create: Executing SQL query for CUSPID=TREASURY-001
2025/10/29 19:10:27 [TREASURY SERVICE] Create: SQL = INSERT INTO treasuries (cuspid, purchased, maturity, amount, yield, buy_price) 
			  VALUES (?, ?, ?, ?, ?, ?) 
			  RETURNING cuspid, purchased, maturity, amount, yield, buy_price, current_value, exit_price, created_at, updated_at
2025/10/29 19:10:27 [TREASURY SERVICE] Create: Successfully created treasury for CUSPID=TREASURY-001
2025/10/29 19:10:27 [TREASURY SERVICE] Create: Created treasury data - Amount=50000.00, Yield=4.000, BuyPrice=49750.00, CreatedAt=2025-10-30 00:10:27 +0000 UTC
2025/10/29 19:10:27 [TREASURY SERVICE] Create: Starting creation for CUSPID=TREASURY-002
2025/10/29 19:10:27 [TREASURY SERVICE] Create: Parameters - Purchased=2024-04-01 00:00:00 +0000 UTC, Maturity=2025-04-01 00:00:00 +0000 UTC, Amount=60000.00, Yield=4.400, BuyPrice=59700.00
2025/10/29 19:10:27 [TREASURY SERVICE] Create: Executing SQL query for CUSPID=TREASURY-002
2025/10/29 19:10:27 [TREASURY SERVICE] Create: SQL = INSERT INTO treasuries (cuspid, purchased, maturity, amount, yield, buy_price) 
			  VALUES (?, ?, ?, ?, ?, ?) 
			  RETURNING cuspid, purchased, maturity, amount, yield, buy_price, current_value, exit_price, created_at, updated_at
2025/10/29 19:10:27 [TREASURY SERVICE] Create: Successfully created treasury for CUSPID=TREASURY-002
2025/10/29 19:10:27 [TREASURY SERVICE] Create: Created treasury data - Amount=60000.00, Yield=4.400, BuyPrice=59700.00, CreatedAt=2025-10-30 00:10:27 +0000 UTC
2025/10/29 19:10:27 [TREASURY SERVICE] Create: Starting creation for CUSPID=TREASURY-003
2025/10/29 19:10:27 [TREASURY SERVICE] Create: Parameters - Purchased=2024-08-01 00:00:00 +0000 UTC, Maturity=2025-08-01 00:00:00 +0000 UTC, Amount=70000.00, Yield=4.800, BuyPrice=69650.00
2025/10/29 19:10:27 [TREASURY SERVICE] Create: Executing SQL query for CUSPID=TREASURY-003
2025/10/29 19:10:27 [TREASURY SERVICE] Create: SQL = INSERT INTO treasuries (cuspid, purchased, maturity, amount, yield, buy_price) 
			  VALUES (?, ?, ?, ?, ?, ?) 
			  RETURNING cuspid, purchased, maturity, amount, yield, buy_price, current_value, exit_price, created_at, updated_at
2025/10/29 19:10:27 [TREASURY SERVICE] Create: Successfully created treasury for CUSPID=TREASURY-003
2025/10/29 19:10:27 [TREASURY SERVICE] Create: Created treasury data - Amount=70000.00, Yield=4.800, BuyPrice=69650.00, CreatedAt=2025-10-30 00:10:27 +0000 UTC
    comprehensive_charts_test.go:383: ✅ Created comprehensive test data for 5 symbols over 12 months
    comprehensive_charts_test.go:104: ✅ Chart color consistency validated
=== RUN   TestChartDataConsistency/DateFormatConsistency
2025/10/29 19:10:27 [MIGRATION] Commission data migration needed - converting per-contract to total commission
2025/10/29 19:10:27 Database backup created: data\backups\test_comprehensive.2025-10-29-19-10-27.db
2025/10/29 19:10:27 [MIGRATION] Pre-migration backup created: data\backups\test_comprehensive.2025-10-29-19-10-27.db
2025/10/29 19:10:27 [MIGRATION] Updated 0 option records with total commission
2025/10/29 19:10:27 [MIGRATION] Commission data migration completed successfully
2025/10/29 19:10:27 [TREASURY SERVICE] Create: Starting creation for CUSPID=TREASURY-001
2025/10/29 19:10:27 [TREASURY SERVICE] Create: Parameters - Purchased=2023-12-01 00:00:00 +0000 UTC, Maturity=2024-12-01 00:00:00 +0000 UTC, Amount=50000.00, Yield=4.000, BuyPrice=49750.00
2025/10/29 19:10:27 [TREASURY SERVICE] Create: Executing SQL query for CUSPID=TREASURY-001
2025/10/29 19:10:27 [TREASURY SERVICE] Create: SQL = INSERT INTO treasuries (cuspid, purchased, maturity, amount, yield, buy_price) 
			  VALUES (?, ?, ?, ?, ?, ?) 
			  RETURNING cuspid, purchased, maturity, amount, yield, buy_price, current_value, exit_price, created_at, updated_at
2025/10/29 19:10:27 [TREASURY SERVICE] Create: Successfully created treasury for CUSPID=TREASURY-001
2025/10/29 19:10:27 [TREASURY SERVICE] Create: Created treasury data - Amount=50000.00, Yield=4.000, BuyPrice=49750.00, CreatedAt=2025-10-30 00:10:27 +0000 UTC
2025/10/29 19:10:27 [TREASURY SERVICE] Create: Starting creation for CUSPID=TREASURY-002
2025/10/29 19:10:27 [TREASURY SERVICE] Create: Parameters - Purchased=2024-04-01 00:00:00 +0000 UTC, Maturity=2025-04-01 00:00:00 +0000 UTC, Amount=60000.00, Yield=4.400, BuyPrice=59700.00
2025/10/29 19:10:27 [TREASURY SERVICE] Create: Executing SQL query for CUSPID=TREASURY-002
2025/10/29 19:10:27 [TREASURY SERVICE] Create: SQL = INSERT INTO treasuries (cuspid, purchased, maturity, amount, yield, buy_price) 
			  VALUES (?, ?, ?, ?, ?, ?) 
			  RETURNING cuspid, purchased, maturity, amount, yield, buy_price, current_value, exit_price, created_at, updated_at
2025/10/29 19:10:27 [TREASURY SERVICE] Create: Successfully created treasury for CUSPID=TREASURY-002
2025/10/29 19:10:27 [TREASURY SERVICE] Create: Created treasury data - Amount=60000.00, Yield=4.400, BuyPrice=59700.00, CreatedAt=2025-10-30 00:10:27 +0000 UTC
2025/10/29 19:10:28 [TREASURY SERVICE] Create: Starting creation for CUSPID=TREASURY-003
2025/10/29 19:10:28 [TREASURY SERVICE] Create: Parameters - Purchased=2024-08-01 00:00:00 +0000 UTC, Maturity=2025-08-01 00:00:00 +0000 UTC, Amount=70000.00, Yield=4.800, BuyPrice=69650.00
2025/10/29 19:10:28 [TREASURY SERVICE] Create: Executing SQL query for CUSPID=TREASURY-003
2025/10/29 19:10:28 [TREASURY SERVICE] Create: SQL = INSERT INTO treasuries (cuspid, purchased, maturity, amount, yield, buy_price) 
			  VALUES (?, ?, ?, ?, ?, ?) 
			  RETURNING cuspid, purchased, maturity, amount, yield, buy_price, current_value, exit_price, created_at, updated_at
2025/10/29 19:10:28 [TREASURY SERVICE] Create: Successfully created treasury for CUSPID=TREASURY-003
2025/10/29 19:10:28 [TREASURY SERVICE] Create: Created treasury data - Amount=70000.00, Yield=4.800, BuyPrice=69650.00, CreatedAt=2025-10-30 00:10:28 +0000 UTC
    comprehensive_charts_test.go:383: ✅ Created comprehensive test data for 5 symbols over 12 months
    comprehensive_charts_test.go:132: ✅ Date format consistency validated
=== RUN   TestChartDataConsistency/FinancialPrecisionConsistency
2025/10/29 19:10:28 [MIGRATION] Commission data migration needed - converting per-contract to total commission
2025/10/29 19:10:28 Database backup created: data\backups\test_comprehensive.2025-10-29-19-10-28.db
2025/10/29 19:10:28 [MIGRATION] Pre-migration backup created: data\backups\test_comprehensive.2025-10-29-19-10-28.db
2025/10/29 19:10:28 [MIGRATION] Updated 0 option records with total commission
2025/10/29 19:10:28 [MIGRATION] Commission data migration completed successfully
2025/10/29 19:10:28 [TREASURY SERVICE] Create: Starting creation for CUSPID=TREASURY-001
2025/10/29 19:10:28 [TREASURY SERVICE] Create: Parameters - Purchased=2023-12-01 00:00:00 +0000 UTC, Maturity=2024-12-01 00:00:00 +0000 UTC, Amount=50000.00, Yield=4.000, BuyPrice=49750.00
2025/10/29 19:10:28 [TREASURY SERVICE] Create: Executing SQL query for CUSPID=TREASURY-001
2025/10/29 19:10:28 [TREASURY SERVICE] Create: SQL = INSERT INTO treasuries (cuspid, purchased, maturity, amount, yield, buy_price) 
			  VALUES (?, ?, ?, ?, ?, ?) 
			  RETURNING cuspid, purchased, maturity, amount, yield, buy_price, current_value, exit_price, created_at, updated_at
2025/10/29 19:10:28 [TREASURY SERVICE] Create: Successfully created treasury for CUSPID=TREASURY-001
2025/10/29 19:10:28 [TREASURY SERVICE] Create: Created treasury data - Amount=50000.00, Yield=4.000, BuyPrice=49750.00, CreatedAt=2025-10-30 00:10:28 +0000 UTC
2025/10/29 19:10:28 [TREASURY SERVICE] Create: Starting creation for CUSPID=TREASURY-002
2025/10/29 19:10:28 [TREASURY SERVICE] Create: Parameters - Purchased=2024-04-01 00:00:00 +0000 UTC, Maturity=2025-04-01 00:00:00 +0000 UTC, Amount=60000.00, Yield=4.400, BuyPrice=59700.00
2025/10/29 19:10:28 [TREASURY SERVICE] Create: Executing SQL query for CUSPID=TREASURY-002
2025/10/29 19:10:28 [TREASURY SERVICE] Create: SQL = INSERT INTO treasuries (cuspid, purchased, maturity, amount, yield, buy_price) 
			  VALUES (?, ?, ?, ?, ?, ?) 
			  RETURNING cuspid, purchased, maturity, amount, yield, buy_price, current_value, exit_price, created_at, updated_at
2025/10/29 19:10:28 [TREASURY SERVICE] Create: Successfully created treasury for CUSPID=TREASURY-002
2025/10/29 19:10:28 [TREASURY SERVICE] Create: Created treasury data - Amount=60000.00, Yield=4.400, BuyPrice=59700.00, CreatedAt=2025-10-30 00:10:28 +0000 UTC
2025/10/29 19:10:28 [TREASURY SERVICE] Create: Starting creation for CUSPID=TREASURY-003
2025/10/29 19:10:28 [TREASURY SERVICE] Create: Parameters - Purchased=2024-08-01 00:00:00 +0000 UTC, Maturity=2025-08-01 00:00:00 +0000 UTC, Amount=70000.00, Yield=4.800, BuyPrice=69650.00
2025/10/29 19:10:28 [TREASURY SERVICE] Create: Executing SQL query for CUSPID=TREASURY-003
2025/10/29 19:10:28 [TREASURY SERVICE] Create: SQL = INSERT INTO treasuries (cuspid, purchased, maturity, amount, yield, buy_price) 
			  VALUES (?, ?, ?, ?, ?, ?) 
			  RETURNING cuspid, purchased, maturity, amount, yield, buy_price, current_value, exit_price, created_at, updated_at
2025/10/29 19:10:28 [TREASURY SERVICE] Create: Successfully created treasury for CUSPID=TREASURY-003
2025/10/29 19:10:28 [TREASURY SERVICE] Create: Created treasury data - Amount=70000.00, Yield=4.800, BuyPrice=69650.00, CreatedAt=2025-10-30 00:10:28 +0000 UTC
    comprehensive_charts_test.go:383: ✅ Created comprehensive test data for 5 symbols over 12 months
    comprehensive_charts_test.go:153: ✅ Financial precision consistency validated
=== RUN   TestChartDataConsistency/StructuralConsistency
2025/10/29 19:10:28 [MIGRATION] Commission data migration needed - converting per-contract to total commission
2025/10/29 19:10:28 Database backup created: data\backups\test_comprehensive.2025-10-29-19-10-28.db
2025/10/29 19:10:28 [MIGRATION] Pre-migration backup created: data\backups\test_comprehensive.2025-10-29-19-10-28.db
2025/10/29 19:10:28 [MIGRATION] Updated 0 option records with total commission
2025/10/29 19:10:28 [MIGRATION] Commission data migration completed successfully
2025/10/29 19:10:28 [TREASURY SERVICE] Create: Starting creation for CUSPID=TREASURY-001
2025/10/29 19:10:28 [TREASURY SERVICE] Create: Parameters - Purchased=2023-12-01 00:00:00 +0000 UTC, Maturity=2024-12-01 00:00:00 +0000 UTC, Amount=50000.00, Yield=4.000, BuyPrice=49750.00
2025/10/29 19:10:28 [TREASURY SERVICE] Create: Executing SQL query for CUSPID=TREASURY-001
2025/10/29 19:10:28 [TREASURY SERVICE] Create: SQL = INSERT INTO treasuries (cuspid, purchased, maturity, amount, yield, buy_price) 
			  VALUES (?, ?, ?, ?, ?, ?) 
			  RETURNING cuspid, purchased, maturity, amount, yield, buy_price, current_value, exit_price, created_at, updated_at
2025/10/29 19:10:28 [TREASURY SERVICE] Create: Successfully created treasury for CUSPID=TREASURY-001
2025/10/29 19:10:28 [TREASURY SERVICE] Create: Created treasury data - Amount=50000.00, Yield=4.000, BuyPrice=49750.00, CreatedAt=2025-10-30 00:10:28 +0000 UTC
2025/10/29 19:10:28 [TREASURY SERVICE] Create: Starting creation for CUSPID=TREASURY-002
2025/10/29 19:10:28 [TREASURY SERVICE] Create: Parameters - Purchased=2024-04-01 00:00:00 +0000 UTC, Maturity=2025-04-01 00:00:00 +0000 UTC, Amount=60000.00, Yield=4.400, BuyPrice=59700.00
2025/10/29 19:10:28 [TREASURY SERVICE] Create: Executing SQL query for CUSPID=TREASURY-002
2025/10/29 19:10:28 [TREASURY SERVICE] Create: SQL = INSERT INTO treasuries (cuspid, purchased, maturity, amount, yield, buy_price) 
			  VALUES (?, ?, ?, ?, ?, ?) 
			  RETURNING cuspid, purchased, maturity, amount, yield, buy_price, current_value, exit_price, created_at, updated_at
2025/10/29 19:10:28 [TREASURY SERVICE] Create: Successfully created treasury for CUSPID=TREASURY-002
2025/10/29 19:10:28 [TREASURY SERVICE] Create: Created treasury data - Amount=60000.00, Yield=4.400, BuyPrice=59700.00, CreatedAt=2025-10-30 00:10:28 +0000 UTC
2025/10/29 19:10:28 [TREASURY SERVICE] Create: Starting creation for CUSPID=TREASURY-003
2025/10/29 19:10:28 [TREASURY SERVICE] Create: Parameters - Purchased=2024-08-01 00:00:00 +0000 UTC, Maturity=2025-08-01 00:00:00 +0000 UTC, Amount=70000.00, Yield=4.800, BuyPrice=69650.00
2025/10/29 19:10:28 [TREASURY SERVICE] Create: Executing SQL query for CUSPID=TREASURY-003
2025/10/29 19:10:28 [TREASURY SERVICE] Create: SQL = INSERT INTO treasuries (cuspid, purchased, maturity, amount, yield, buy_price) 
			  VALUES (?, ?, ?, ?, ?, ?) 
			  RETURNING cuspid, purchased, maturity, amount, yield, buy_price, current_value, exit_price, created_at, updated_at
2025/10/29 19:10:28 [TREASURY SERVICE] Create: Successfully created treasury for CUSPID=TREASURY-003
2025/10/29 19:10:28 [TREASURY SERVICE] Create: Created treasury data - Amount=70000.00, Yield=4.800, BuyPrice=69650.00, CreatedAt=2025-10-30 00:10:28 +0000 UTC
    comprehensive_charts_test.go:383: ✅ Created comprehensive test data for 5 symbols over 12 months
    comprehensive_charts_test.go:191: ✅ AllocationData structural consistency validated (853 bytes JSON)
    comprehensive_charts_test.go:191: ✅ MonthlyData structural consistency validated (1592 bytes JSON)
    comprehensive_charts_test.go:191: ✅ SymbolData structural consistency validated (834 bytes JSON)
    comprehensive_charts_test.go:191: ✅ MetricsData structural consistency validated (629 bytes JSON)
    comprehensive_charts_test.go:191: ✅ TreasuryData structural consistency validated (1033 bytes JSON)
--- PASS: TestChartDataConsistency (1.74s)
    --- PASS: TestChartDataConsistency/ColorConsistency (0.52s)
    --- PASS: TestChartDataConsistency/DateFormatConsistency (0.36s)
    --- PASS: TestChartDataConsistency/FinancialPrecisionConsistency (0.43s)
    --- PASS: TestChartDataConsistency/StructuralConsistency (0.43s)
=== RUN   TestChartPerformanceAndScaling
=== RUN   TestChartPerformanceAndScaling/LargeDatasetHandling
2025/10/29 19:10:29 [MIGRATION] Commission data migration needed - converting per-contract to total commission
2025/10/29 19:10:29 Database backup created: data\backups\test_large.2025-10-29-19-10-29.db
2025/10/29 19:10:29 [MIGRATION] Pre-migration backup created: data\backups\test_large.2025-10-29-19-10-29.db
2025/10/29 19:10:29 [MIGRATION] Updated 0 option records with total commission
2025/10/29 19:10:29 [MIGRATION] Commission data migration completed successfully
    comprehensive_charts_test.go:424: ✅ Created large test data with 50 symbols and 500+ options
    comprehensive_charts_test.go:235: ✅ Large dataset performance: Build=0s, Serialize=0s, Deserialize=0s, JSON Size=853 bytes
--- PASS: TestChartPerformanceAndScaling (0.39s)
    --- PASS: TestChartPerformanceAndScaling/LargeDatasetHandling (0.39s)
=== RUN   TestGetDashboard
2025/10/29 19:10:29 [DASHBOARD] Found 0 symbols for navigation: []
2025/10/29 19:10:29 [TREASURY SERVICE] GetAll: Starting to retrieve all treasuries
2025/10/29 19:10:29 [TREASURY SERVICE] GetAll: Executing SQL query
2025/10/29 19:10:29 [TREASURY SERVICE] GetAll: SQL = SELECT cuspid, purchased, maturity, amount, yield, buy_price, current_value, exit_price, created_at, updated_at 
			  FROM treasuries ORDER BY maturity DESC, purchased DESC
2025/10/29 19:10:29 [TREASURY SERVICE] GetAll: Successfully retrieved 0 treasuries
2025/10/29 19:10:29 [DASHBOARD] Building dashboard data with 0 symbols: []
2025/10/29 19:10:29 [DASHBOARD] Built 0 symbol summaries
2025/10/29 19:10:29 [TEMPLATE] Starting template execution for: dashboard.html
2025/10/29 19:10:29 [TEMPLATE] Successfully rendered template: dashboard.html
    dashboard_test.go:68: ✅ Dashboard test passed - HTML contains expected Wheeler content
--- PASS: TestGetDashboard (0.00s)
=== RUN   TestMonthlyDataStructure
2025/10/29 19:10:29 [MIGRATION] Commission data migration needed - converting per-contract to total commission
2025/10/29 19:10:29 Database backup created: data\backups\test_monthly.2025-10-29-19-10-29.db
2025/10/29 19:10:29 [MIGRATION] Pre-migration backup created: data\backups\test_monthly.2025-10-29-19-10-29.db
2025/10/29 19:10:29 [MIGRATION] Updated 0 option records with total commission
2025/10/29 19:10:29 [MIGRATION] Commission data migration completed successfully
    monthly_handlers_test.go:1034: Created AAPL put option 1 for month 1
    monthly_handlers_test.go:1045: Created TSLA call option 2 for month 1
    monthly_handlers_test.go:1062: Would close NVDA position for month 0
    monthly_handlers_test.go:1034: Created AAPL put option 3 for month 2
    monthly_handlers_test.go:1045: Created TSLA call option 4 for month 2
    monthly_handlers_test.go:1034: Created AAPL put option 5 for month 3
    monthly_handlers_test.go:1045: Created TSLA call option 6 for month 3
    monthly_handlers_test.go:1062: Would close NVDA position for month 2
    monthly_handlers_test.go:1034: Created AAPL put option 7 for month 4
    monthly_handlers_test.go:1045: Created TSLA call option 8 for month 4
    monthly_handlers_test.go:1034: Created AAPL put option 9 for month 5
    monthly_handlers_test.go:1045: Created TSLA call option 10 for month 5
    monthly_handlers_test.go:1062: Would close NVDA position for month 4
    monthly_handlers_test.go:1034: Created AAPL put option 11 for month 6
    monthly_handlers_test.go:1045: Created TSLA call option 12 for month 6
    monthly_handlers_test.go:1082: ✅ Created deterministic monthly test data for 6 months
=== RUN   TestMonthlyDataStructure/PutsData
=== RUN   TestMonthlyDataStructure/CallsData
=== RUN   TestMonthlyDataStructure/CapGainsData
=== RUN   TestMonthlyDataStructure/DividendsData
=== RUN   TestMonthlyDataStructure/MonthlyPremiumsBySymbol
=== RUN   TestMonthlyDataStructure/TableData
=== RUN   TestMonthlyDataStructure/TotalsByMonth
=== RUN   TestMonthlyDataStructure/FinancialCalculations
=== NAME  TestMonthlyDataStructure
    monthly_handlers_test.go:231: ✅ MonthlyData structure validation passed - Symbols: 3, GrandTotal: $7594.00
--- PASS: TestMonthlyDataStructure (0.27s)
    --- PASS: TestMonthlyDataStructure/PutsData (0.00s)
    --- PASS: TestMonthlyDataStructure/CallsData (0.00s)
    --- PASS: TestMonthlyDataStructure/CapGainsData (0.00s)
    --- PASS: TestMonthlyDataStructure/DividendsData (0.00s)
    --- PASS: TestMonthlyDataStructure/MonthlyPremiumsBySymbol (0.00s)
    --- PASS: TestMonthlyDataStructure/TableData (0.00s)
    --- PASS: TestMonthlyDataStructure/TotalsByMonth (0.00s)
    --- PASS: TestMonthlyDataStructure/FinancialCalculations (0.00s)
=== RUN   TestMonthlyChartDataTypes
=== RUN   TestMonthlyChartDataTypes/MonthlyChartData
=== RUN   TestMonthlyChartDataTypes/TickerChartData
=== RUN   TestMonthlyChartDataTypes/MonthlyPremiumsBySymbol
=== RUN   TestMonthlyChartDataTypes/MonthlyTableRow
=== NAME  TestMonthlyChartDataTypes
    monthly_handlers_test.go:358: ✅ MonthlyChartData types validation passed
--- PASS: TestMonthlyChartDataTypes (0.00s)
    --- PASS: TestMonthlyChartDataTypes/MonthlyChartData (0.00s)
    --- PASS: TestMonthlyChartDataTypes/TickerChartData (0.00s)
    --- PASS: TestMonthlyChartDataTypes/MonthlyPremiumsBySymbol (0.00s)
    --- PASS: TestMonthlyChartDataTypes/MonthlyTableRow (0.00s)
=== RUN   TestCallsByMonthCalculation
2025/10/29 19:10:29 [MIGRATION] Commission data migration needed - converting per-contract to total commission
2025/10/29 19:10:29 Database backup created: data\backups\test_calls_may.2025-10-29-19-10-29.db
2025/10/29 19:10:29 [MIGRATION] Pre-migration backup created: data\backups\test_calls_may.2025-10-29-19-10-29.db
2025/10/29 19:10:29 [MIGRATION] Updated 0 option records with total commission
2025/10/29 19:10:29 [MIGRATION] Commission data migration completed successfully
    monthly_handlers_test.go:621: Created CVX call: $0.60 x1 = $60.00 (closed 2025-05-09)
    monthly_handlers_test.go:621: Created MMM call: $1.30 x1 = $130.00 (closed 2025-05-09)
    monthly_handlers_test.go:621: Created KO call: $0.35 x1 = $35.00 (closed 2025-05-16)
    monthly_handlers_test.go:621: Created USB call: $0.10 x1 = $10.00 (closed 2025-05-23)
    monthly_handlers_test.go:621: Created VZ call: $0.35 x1 = $35.00 (closed 2025-05-27)
    monthly_handlers_test.go:621: Created VZ call: $0.31 x1 = $31.00 (closed 2025-05-29)
    monthly_handlers_test.go:621: Created KO call: $0.12 x1 = $12.00 (closed 2025-05-30)
    monthly_handlers_test.go:621: Created MMM call: $0.80 x1 = $80.00 (closed 2025-05-30)
    monthly_handlers_test.go:625: ✅ Created May call test data - Expected total: $393.00
    monthly_handlers_test.go:657: ✅ Created comparison data for April
=== RUN   TestCallsByMonthCalculation/MayCallsCalculation
    monthly_handlers_test.go:411: Found 8 call options closed in May 2025:
    monthly_handlers_test.go:419:   Option 1: CVX Call $0.60 x1 = $60.00 (closed: 2025-05-09, month index: 4)
    monthly_handlers_test.go:419:   Option 2: MMM Call $1.30 x1 = $130.00 (closed: 2025-05-09, month index: 4)
    monthly_handlers_test.go:419:   Option 3: KO Call $0.35 x1 = $35.00 (closed: 2025-05-16, month index: 4)
    monthly_handlers_test.go:419:   Option 4: USB Call $0.10 x1 = $10.00 (closed: 2025-05-23, month index: 4)
    monthly_handlers_test.go:419:   Option 5: VZ Call $0.35 x1 = $35.00 (closed: 2025-05-27, month index: 4)
    monthly_handlers_test.go:419:   Option 6: VZ Call $0.31 x1 = $31.00 (closed: 2025-05-29, month index: 4)
    monthly_handlers_test.go:419:   Option 7: KO Call $0.12 x1 = $12.00 (closed: 2025-05-30, month index: 4)
    monthly_handlers_test.go:419:   Option 8: MMM Call $0.80 x1 = $80.00 (closed: 2025-05-30, month index: 4)
    monthly_handlers_test.go:428: Expected May call total: $393.00
    monthly_handlers_test.go:453:   Handler processing: MMM Call $0.80 x1 = $80.00 (month 4)
    monthly_handlers_test.go:453:   Handler processing: KO Call $0.12 x1 = $12.00 (month 4)
    monthly_handlers_test.go:453:   Handler processing: VZ Call $0.31 x1 = $31.00 (month 4)
    monthly_handlers_test.go:453:   Handler processing: VZ Call $0.35 x1 = $35.00 (month 4)
    monthly_handlers_test.go:453:   Handler processing: USB Call $0.10 x1 = $10.00 (month 4)
    monthly_handlers_test.go:453:   Handler processing: KO Call $0.35 x1 = $35.00 (month 4)
    monthly_handlers_test.go:453:   Handler processing: MMM Call $1.30 x1 = $130.00 (month 4)
    monthly_handlers_test.go:453:   Handler processing: CVX Call $0.60 x1 = $60.00 (month 4)
    monthly_handlers_test.go:460: Actual May call total from handler logic: $393.00
=== RUN   TestCallsByMonthCalculation/AllMonthsConsistency
    monthly_handlers_test.go:516: Calls by month breakdown:
    monthly_handlers_test.go:519:   Apr: $2930.00
    monthly_handlers_test.go:519:   May: $393.00
--- PASS: TestCallsByMonthCalculation (0.30s)
    --- PASS: TestCallsByMonthCalculation/MayCallsCalculation (0.00s)
    --- PASS: TestCallsByMonthCalculation/AllMonthsConsistency (0.00s)
=== RUN   TestMonthlyHandlerWithRealData
2025/10/29 19:10:30 [MIGRATION] Commission data migration needed - converting per-contract to total commission
2025/10/29 19:10:30 Database backup created: data\backups\test_wheeler_reproduction.2025-10-29-19-10-30.db
2025/10/29 19:10:30 [MIGRATION] Pre-migration backup created: data\backups\test_wheeler_reproduction.2025-10-29-19-10-30.db
2025/10/29 19:10:30 [MIGRATION] Updated 0 option records with total commission
2025/10/29 19:10:30 [MIGRATION] Commission data migration completed successfully
    monthly_handlers_test.go:924: Recreated CVX call: $0.60 x1 = $60.00 (closed: 2025-05-09)
    monthly_handlers_test.go:924: Recreated MMM call: $1.30 x1 = $130.00 (closed: 2025-05-09)
    monthly_handlers_test.go:924: Recreated KO call: $0.35 x1 = $35.00 (closed: 2025-05-16)
    monthly_handlers_test.go:924: Recreated USB call: $0.10 x1 = $10.00 (closed: 2025-05-23)
    monthly_handlers_test.go:924: Recreated VZ call: $0.35 x1 = $35.00 (closed: 2025-05-27)
    monthly_handlers_test.go:924: Recreated VZ call: $0.31 x1 = $31.00 (closed: 2025-05-29)
    monthly_handlers_test.go:924: Recreated KO call: $0.12 x1 = $12.00 (closed: 2025-05-30)
    monthly_handlers_test.go:924: Recreated MMM call: $0.80 x1 = $80.00 (closed: 2025-05-30)
    monthly_handlers_test.go:959: ✅ Recreated wheeler.db call options - May total should be: $393.00
    monthly_handlers_test.go:971: Verification: Created 8 May call options totaling $393.00
    monthly_handlers_test.go:690: May calls from handler: $92.20
    monthly_handlers_test.go:697: ❌ May calls calculation incorrect: got $92.20, expected ~$393.00
    monthly_handlers_test.go:701: All calls by month:
    monthly_handlers_test.go:704:   Mar: $1159.30
    monthly_handlers_test.go:704:   Apr: $92.40
    monthly_handlers_test.go:704:   May: $92.20
--- FAIL: TestMonthlyHandlerWithRealData (0.37s)
=== RUN   TestSymbolDataStructure
2025/10/29 19:10:30 [MIGRATION] Commission data migration needed - converting per-contract to total commission
2025/10/29 19:10:30 Database backup created: data\backups\test_symbol.2025-10-29-19-10-30.db
2025/10/29 19:10:30 [MIGRATION] Pre-migration backup created: data\backups\test_symbol.2025-10-29-19-10-30.db
2025/10/29 19:10:30 [MIGRATION] Updated 0 option records with total commission
2025/10/29 19:10:30 [MIGRATION] Commission data migration completed successfully
    symbol_handlers_test.go:451: ✅ Created deterministic symbol test data for 3 symbols over 6 months
=== RUN   TestSymbolDataStructure/BasicSymbolInfo
=== RUN   TestSymbolDataStructure/FinancialCalculations
=== RUN   TestSymbolDataStructure/DividendInfo
=== RUN   TestSymbolDataStructure/OptionsList
=== RUN   TestSymbolDataStructure/LongPositionsList
=== RUN   TestSymbolDataStructure/MonthlyResults
=== NAME  TestSymbolDataStructure
    symbol_handlers_test.go:216: ✅ SymbolData structure validation passed for AAPL - 9 options, 2 positions, 6 monthly results
--- PASS: TestSymbolDataStructure (0.39s)
    --- PASS: TestSymbolDataStructure/BasicSymbolInfo (0.00s)
    --- PASS: TestSymbolDataStructure/FinancialCalculations (0.00s)
    --- PASS: TestSymbolDataStructure/DividendInfo (0.00s)
    --- PASS: TestSymbolDataStructure/OptionsList (0.00s)
    --- PASS: TestSymbolDataStructure/LongPositionsList (0.00s)
    --- PASS: TestSymbolDataStructure/MonthlyResults (0.00s)
=== RUN   TestSymbolMonthlyResultType
    symbol_handlers_test.go:263: ✅ SymbolMonthlyResult type validation passed
--- PASS: TestSymbolMonthlyResultType (0.00s)
=== RUN   TestSymbolHandlerEndpoint
2025/10/29 19:10:30 [MIGRATION] Commission data migration needed - converting per-contract to total commission
2025/10/29 19:10:30 Database backup created: data\backups\test_symbol.2025-10-29-19-10-30.db
2025/10/29 19:10:30 [MIGRATION] Pre-migration backup created: data\backups\test_symbol.2025-10-29-19-10-30.db
2025/10/29 19:10:30 [MIGRATION] Updated 0 option records with total commission
2025/10/29 19:10:30 [MIGRATION] Commission data migration completed successfully
    symbol_handlers_test.go:451: ✅ Created deterministic symbol test data for 3 symbols over 6 months
    symbol_handlers_test.go:305: ✅ Symbol handler endpoint test passed
--- PASS: TestSymbolHandlerEndpoint (0.31s)
=== RUN   TestMultipleSymbolsMonthlyData
2025/10/29 19:10:31 [MIGRATION] Commission data migration needed - converting per-contract to total commission
2025/10/29 19:10:31 Database backup created: data\backups\test_symbol.2025-10-29-19-10-31.db
2025/10/29 19:10:31 [MIGRATION] Pre-migration backup created: data\backups\test_symbol.2025-10-29-19-10-31.db
2025/10/29 19:10:31 [MIGRATION] Updated 0 option records with total commission
2025/10/29 19:10:31 [MIGRATION] Commission data migration completed successfully
    symbol_handlers_test.go:451: ✅ Created deterministic symbol test data for 3 symbols over 6 months
=== RUN   TestMultipleSymbolsMonthlyData/AAPL
    symbol_handlers_test.go:342: ✅ Symbol AAPL validation passed - 6 monthly results
=== RUN   TestMultipleSymbolsMonthlyData/TSLA
    symbol_handlers_test.go:342: ✅ Symbol TSLA validation passed - 6 monthly results
=== RUN   TestMultipleSymbolsMonthlyData/NVDA
    symbol_handlers_test.go:342: ✅ Symbol NVDA validation passed - 6 monthly results
--- PASS: TestMultipleSymbolsMonthlyData (0.36s)
    --- PASS: TestMultipleSymbolsMonthlyData/AAPL (0.00s)
    --- PASS: TestMultipleSymbolsMonthlyData/TSLA (0.00s)
    --- PASS: TestMultipleSymbolsMonthlyData/NVDA (0.00s)
=== RUN   TestOptionAROICalculation
=== RUN   TestOptionAROICalculation/PutOption_TwoWeeks_Profit
    symbol_handlers_test.go:634: ✅ Put Option AROI: 49.5% (14 days, $100 profit, $5200 exposure)
=== RUN   TestOptionAROICalculation/CallOption_OneMonth_Loss
    symbol_handlers_test.go:673: ✅ Call Option AROI: -4.2% (30 days, -$50 loss, $15000 exposure)
=== RUN   TestOptionAROICalculation/OpenPosition_CurrentCalculation
    symbol_handlers_test.go:711: ✅ Open Position AROI: 64.9% (7 days so far, $125 current profit, $10000 exposure)
=== RUN   TestOptionAROICalculation/EdgeCase_ZeroCapital
    symbol_handlers_test.go:737: ✅ Zero Capital Edge Case: AROI = 0.0%
--- PASS: TestOptionAROICalculation (0.00s)
    --- PASS: TestOptionAROICalculation/PutOption_TwoWeeks_Profit (0.00s)
    --- PASS: TestOptionAROICalculation/CallOption_OneMonth_Loss (0.00s)
    --- PASS: TestOptionAROICalculation/OpenPosition_CurrentCalculation (0.00s)
    --- PASS: TestOptionAROICalculation/EdgeCase_ZeroCapital (0.00s)
=== RUN   TestTreasuriesDataStructure
2025/10/29 19:10:31 [MIGRATION] Commission data migration needed - converting per-contract to total commission
2025/10/29 19:10:31 Database backup created: data\backups\test_treasury.2025-10-29-19-10-31.db
2025/10/29 19:10:31 [MIGRATION] Pre-migration backup created: data\backups\test_treasury.2025-10-29-19-10-31.db
2025/10/29 19:10:31 [MIGRATION] Updated 0 option records with total commission
2025/10/29 19:10:31 [MIGRATION] Commission data migration completed successfully
2025/10/29 19:10:31 [TREASURY SERVICE] CreateFull: Starting creation for CUSPID=TREASURY-001
2025/10/29 19:10:31 [TREASURY SERVICE] CreateFull: Parameters - Purchased=2023-10-15 00:00:00 +0000 UTC, Maturity=2025-01-15 00:00:00 +0000 UTC, Amount=50000.00, Yield=4.250, BuyPrice=49750.00
2025/10/29 19:10:31 [TREASURY SERVICE] CreateFull: CurrentValue=50125.00
2025/10/29 19:10:31 [TREASURY SERVICE] CreateFull: ExitPrice=nil
2025/10/29 19:10:31 [TREASURY SERVICE] CreateFull: Executing SQL query for CUSPID=TREASURY-001
2025/10/29 19:10:31 [TREASURY SERVICE] CreateFull: SQL = INSERT INTO treasuries (cuspid, purchased, maturity, amount, yield, buy_price, current_value, exit_price) 
			  VALUES (?, ?, ?, ?, ?, ?, ?, ?) 
			  RETURNING cuspid, purchased, maturity, amount, yield, buy_price, current_value, exit_price, created_at, updated_at
2025/10/29 19:10:31 [TREASURY SERVICE] CreateFull: Successfully created treasury for CUSPID=TREASURY-001
2025/10/29 19:10:31 [TREASURY SERVICE] CreateFull: Created treasury data - Amount=50000.00, Yield=4.250, BuyPrice=49750.00, CreatedAt=2025-10-30 00:10:31 +0000 UTC
2025/10/29 19:10:31 [TREASURY SERVICE] CreateFull: Starting creation for CUSPID=TREASURY-002
2025/10/29 19:10:31 [TREASURY SERVICE] CreateFull: Parameters - Purchased=2023-10-15 00:00:00 +0000 UTC, Maturity=2025-07-15 00:00:00 +0000 UTC, Amount=75000.00, Yield=4.750, BuyPrice=74500.00
2025/10/29 19:10:31 [TREASURY SERVICE] CreateFull: CurrentValue=75850.00
2025/10/29 19:10:31 [TREASURY SERVICE] CreateFull: ExitPrice=nil
2025/10/29 19:10:31 [TREASURY SERVICE] CreateFull: Executing SQL query for CUSPID=TREASURY-002
2025/10/29 19:10:31 [TREASURY SERVICE] CreateFull: SQL = INSERT INTO treasuries (cuspid, purchased, maturity, amount, yield, buy_price, current_value, exit_price) 
			  VALUES (?, ?, ?, ?, ?, ?, ?, ?) 
			  RETURNING cuspid, purchased, maturity, amount, yield, buy_price, current_value, exit_price, created_at, updated_at
2025/10/29 19:10:31 [TREASURY SERVICE] CreateFull: Successfully created treasury for CUSPID=TREASURY-002
2025/10/29 19:10:31 [TREASURY SERVICE] CreateFull: Created treasury data - Amount=75000.00, Yield=4.750, BuyPrice=74500.00, CreatedAt=2025-10-30 00:10:31 +0000 UTC
2025/10/29 19:10:31 [TREASURY SERVICE] CreateFull: Starting creation for CUSPID=TREASURY-003
2025/10/29 19:10:31 [TREASURY SERVICE] CreateFull: Parameters - Purchased=2023-10-15 00:00:00 +0000 UTC, Maturity=2024-07-15 00:00:00 +0000 UTC, Amount=100000.00, Yield=5.000, BuyPrice=99250.00
2025/10/29 19:10:31 [TREASURY SERVICE] CreateFull: CurrentValue=101250.00
2025/10/29 19:10:31 [TREASURY SERVICE] CreateFull: ExitPrice=102500.00
2025/10/29 19:10:31 [TREASURY SERVICE] CreateFull: Executing SQL query for CUSPID=TREASURY-003
2025/10/29 19:10:31 [TREASURY SERVICE] CreateFull: SQL = INSERT INTO treasuries (cuspid, purchased, maturity, amount, yield, buy_price, current_value, exit_price) 
			  VALUES (?, ?, ?, ?, ?, ?, ?, ?) 
			  RETURNING cuspid, purchased, maturity, amount, yield, buy_price, current_value, exit_price, created_at, updated_at
2025/10/29 19:10:31 [TREASURY SERVICE] CreateFull: Successfully created treasury for CUSPID=TREASURY-003
2025/10/29 19:10:31 [TREASURY SERVICE] CreateFull: Created treasury data - Amount=100000.00, Yield=5.000, BuyPrice=99250.00, CreatedAt=2025-10-30 00:10:31 +0000 UTC
    treasury_handlers_test.go:460: ✅ Created deterministic treasury test data for 3 treasuries
2025/10/29 19:10:31 [TREASURY SERVICE] GetAll: Starting to retrieve all treasuries
2025/10/29 19:10:31 [TREASURY SERVICE] GetAll: Executing SQL query
2025/10/29 19:10:31 [TREASURY SERVICE] GetAll: SQL = SELECT cuspid, purchased, maturity, amount, yield, buy_price, current_value, exit_price, created_at, updated_at 
			  FROM treasuries ORDER BY maturity DESC, purchased DESC
2025/10/29 19:10:31 [TREASURY SERVICE] GetAll: Scanned treasury 1 - CUSPID=TREASURY-002, Amount=75000.00
2025/10/29 19:10:31 [TREASURY SERVICE] GetAll: Scanned treasury 2 - CUSPID=TREASURY-001, Amount=50000.00
2025/10/29 19:10:31 [TREASURY SERVICE] GetAll: Scanned treasury 3 - CUSPID=TREASURY-003, Amount=100000.00
2025/10/29 19:10:31 [TREASURY SERVICE] GetAll: Successfully retrieved 3 treasuries
=== RUN   TestTreasuriesDataStructure/BasicStructure
=== RUN   TestTreasuriesDataStructure/TreasuryRecords
=== RUN   TestTreasuriesDataStructure/TreasurySummary
=== NAME  TestTreasuriesDataStructure
    treasury_handlers_test.go:154: ✅ TreasuriesData structure validation passed - 3 treasuries, Total: $225000.00, Interest: $5343.75
--- PASS: TestTreasuriesDataStructure (0.34s)
    --- PASS: TestTreasuriesDataStructure/BasicStructure (0.00s)
    --- PASS: TestTreasuriesDataStructure/TreasuryRecords (0.00s)
    --- PASS: TestTreasuriesDataStructure/TreasurySummary (0.00s)
=== RUN   TestTreasuriesSummaryStructure
    treasury_handlers_test.go:201: ✅ TreasuriesSummary type validation passed
--- PASS: TestTreasuriesSummaryStructure (0.00s)
=== RUN   TestTreasuryUpdateRequest
    treasury_handlers_test.go:289: ✅ TreasuryUpdateRequest type validation passed
--- PASS: TestTreasuryUpdateRequest (0.00s)
=== RUN   TestTreasuryCalculations
2025/10/29 19:10:31 [MIGRATION] Commission data migration needed - converting per-contract to total commission
2025/10/29 19:10:31 Database backup created: data\backups\test_treasury.2025-10-29-19-10-31.db
2025/10/29 19:10:31 [MIGRATION] Pre-migration backup created: data\backups\test_treasury.2025-10-29-19-10-31.db
2025/10/29 19:10:31 [MIGRATION] Updated 0 option records with total commission
2025/10/29 19:10:31 [MIGRATION] Commission data migration completed successfully
2025/10/29 19:10:31 [TREASURY SERVICE] CreateFull: Starting creation for CUSPID=TREASURY-001
2025/10/29 19:10:31 [TREASURY SERVICE] CreateFull: Parameters - Purchased=2023-10-15 00:00:00 +0000 UTC, Maturity=2025-01-15 00:00:00 +0000 UTC, Amount=50000.00, Yield=4.250, BuyPrice=49750.00
2025/10/29 19:10:31 [TREASURY SERVICE] CreateFull: CurrentValue=50125.00
2025/10/29 19:10:31 [TREASURY SERVICE] CreateFull: ExitPrice=nil
2025/10/29 19:10:31 [TREASURY SERVICE] CreateFull: Executing SQL query for CUSPID=TREASURY-001
2025/10/29 19:10:31 [TREASURY SERVICE] CreateFull: SQL = INSERT INTO treasuries (cuspid, purchased, maturity, amount, yield, buy_price, current_value, exit_price) 
			  VALUES (?, ?, ?, ?, ?, ?, ?, ?) 
			  RETURNING cuspid, purchased, maturity, amount, yield, buy_price, current_value, exit_price, created_at, updated_at
2025/10/29 19:10:31 [TREASURY SERVICE] CreateFull: Successfully created treasury for CUSPID=TREASURY-001
2025/10/29 19:10:31 [TREASURY SERVICE] CreateFull: Created treasury data - Amount=50000.00, Yield=4.250, BuyPrice=49750.00, CreatedAt=2025-10-30 00:10:31 +0000 UTC
2025/10/29 19:10:31 [TREASURY SERVICE] CreateFull: Starting creation for CUSPID=TREASURY-002
2025/10/29 19:10:31 [TREASURY SERVICE] CreateFull: Parameters - Purchased=2023-10-15 00:00:00 +0000 UTC, Maturity=2025-07-15 00:00:00 +0000 UTC, Amount=75000.00, Yield=4.750, BuyPrice=74500.00
2025/10/29 19:10:31 [TREASURY SERVICE] CreateFull: CurrentValue=75850.00
2025/10/29 19:10:31 [TREASURY SERVICE] CreateFull: ExitPrice=nil
2025/10/29 19:10:31 [TREASURY SERVICE] CreateFull: Executing SQL query for CUSPID=TREASURY-002
2025/10/29 19:10:31 [TREASURY SERVICE] CreateFull: SQL = INSERT INTO treasuries (cuspid, purchased, maturity, amount, yield, buy_price, current_value, exit_price) 
			  VALUES (?, ?, ?, ?, ?, ?, ?, ?) 
			  RETURNING cuspid, purchased, maturity, amount, yield, buy_price, current_value, exit_price, created_at, updated_at
2025/10/29 19:10:31 [TREASURY SERVICE] CreateFull: Successfully created treasury for CUSPID=TREASURY-002
2025/10/29 19:10:31 [TREASURY SERVICE] CreateFull: Created treasury data - Amount=75000.00, Yield=4.750, BuyPrice=74500.00, CreatedAt=2025-10-30 00:10:31 +0000 UTC
2025/10/29 19:10:31 [TREASURY SERVICE] CreateFull: Starting creation for CUSPID=TREASURY-003
2025/10/29 19:10:31 [TREASURY SERVICE] CreateFull: Parameters - Purchased=2023-10-15 00:00:00 +0000 UTC, Maturity=2024-07-15 00:00:00 +0000 UTC, Amount=100000.00, Yield=5.000, BuyPrice=99250.00
2025/10/29 19:10:31 [TREASURY SERVICE] CreateFull: CurrentValue=101250.00
2025/10/29 19:10:31 [TREASURY SERVICE] CreateFull: ExitPrice=102500.00
2025/10/29 19:10:31 [TREASURY SERVICE] CreateFull: Executing SQL query for CUSPID=TREASURY-003
2025/10/29 19:10:31 [TREASURY SERVICE] CreateFull: SQL = INSERT INTO treasuries (cuspid, purchased, maturity, amount, yield, buy_price, current_value, exit_price) 
			  VALUES (?, ?, ?, ?, ?, ?, ?, ?) 
			  RETURNING cuspid, purchased, maturity, amount, yield, buy_price, current_value, exit_price, created_at, updated_at
2025/10/29 19:10:31 [TREASURY SERVICE] CreateFull: Successfully created treasury for CUSPID=TREASURY-003
2025/10/29 19:10:31 [TREASURY SERVICE] CreateFull: Created treasury data - Amount=100000.00, Yield=5.000, BuyPrice=99250.00, CreatedAt=2025-10-30 00:10:31 +0000 UTC
    treasury_handlers_test.go:460: ✅ Created deterministic treasury test data for 3 treasuries
2025/10/29 19:10:31 [TREASURY SERVICE] CreateFull: Starting creation for CUSPID=TEST-BOND-001
2025/10/29 19:10:31 [TREASURY SERVICE] CreateFull: Parameters - Purchased=2024-01-15 00:00:00 +0000 UTC, Maturity=2025-01-15 00:00:00 +0000 UTC, Amount=100000.00, Yield=4.500, BuyPrice=99500.00
2025/10/29 19:10:31 [TREASURY SERVICE] CreateFull: CurrentValue=101250.00
2025/10/29 19:10:31 [TREASURY SERVICE] CreateFull: ExitPrice=nil
2025/10/29 19:10:31 [TREASURY SERVICE] CreateFull: Executing SQL query for CUSPID=TEST-BOND-001
2025/10/29 19:10:31 [TREASURY SERVICE] CreateFull: SQL = INSERT INTO treasuries (cuspid, purchased, maturity, amount, yield, buy_price, current_value, exit_price) 
			  VALUES (?, ?, ?, ?, ?, ?, ?, ?) 
			  RETURNING cuspid, purchased, maturity, amount, yield, buy_price, current_value, exit_price, created_at, updated_at
2025/10/29 19:10:31 [TREASURY SERVICE] CreateFull: Successfully created treasury for CUSPID=TEST-BOND-001
2025/10/29 19:10:31 [TREASURY SERVICE] CreateFull: Created treasury data - Amount=100000.00, Yield=4.500, BuyPrice=99500.00, CreatedAt=2025-10-30 00:10:31 +0000 UTC
=== RUN   TestTreasuryCalculations/ProfitLossCalculation
=== RUN   TestTreasuryCalculations/CurrentValueMethods
=== RUN   TestTreasuryCalculations/ExitPriceMethods
=== NAME  TestTreasuryCalculations
    treasury_handlers_test.go:387: ✅ Treasury calculations test passed
--- PASS: TestTreasuryCalculations (0.29s)
    --- PASS: TestTreasuryCalculations/ProfitLossCalculation (0.00s)
    --- PASS: TestTreasuryCalculations/CurrentValueMethods (0.00s)
    --- PASS: TestTreasuryCalculations/ExitPriceMethods (0.00s)
FAIL
2025/10/29 19:10:32 Shutting down test server
2025/10/29 19:10:32 Wheeler integration tests completed
FAIL	stonks/test	9.121s
FAIL
